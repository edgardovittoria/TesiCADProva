{"version":3,"file":"react-three-gui.cjs.development.js","sources":["../src/contexts/controls-context.ts","../src/components/controls-provider.tsx","../src/types.ts","../src/utils.ts","../src/hooks/use-local-storage.ts","../src/components/controls/base-control.tsx","../src/components/controls/number-control.tsx","../src/components/controls/boolean-control.tsx","../src/components/controls/button-control.tsx","../src/components/controls/color-control.tsx","../src/components/controls/select-control.tsx","../src/components/controls/string-control.tsx","../src/components/controls/xy-pad-control.tsx","../src/components/controls/file-control.tsx","../src/components/control-item.tsx","../src/components/control-group.tsx","../src/components/controls.tsx","../src/hooks/use-control.ts"],"sourcesContent":["import { createContext, RefObject, SetStateAction } from 'react';\nimport { ControlItem } from 'types';\n\ninterface IControlsContext {\n  values: RefObject<Map<string, any>>;\n  gui: RefObject<Map<string, SetStateAction<any>>>;\n  state: RefObject<Map<string, SetStateAction<any>>>;\n  controls: ControlItem[];\n  addControl(control: ControlItem): ControlItem;\n  removeControl(control: ControlItem): any;\n}\n\nexport const ControlsContext = createContext<IControlsContext>({\n  values: { current: new Map() },\n  gui: { current: new Map() },\n  state: { current: new Map() },\n  controls: [],\n  addControl(control: ControlItem) {\n    return control;\n  },\n  removeControl() {},\n});\n","import React, { useState, useRef } from 'react';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { Canvas as R3FCanvas } from 'react-three-fiber';\nimport { ControlItem } from 'types';\n\nexport const ControlsProvider = ({\n  children,\n}: {\n  children: React.ReactNode;\n}) => {\n  const [controls, setControls] = useState<ControlItem[]>([]);\n  // Persist values between reloads\n  const values = useRef(new Map());\n  // GUI control state setters\n  const gui = useRef(new Map());\n  // useControl state setters\n  const state = useRef(new Map());\n\n  const context = {\n    values,\n    gui,\n    state,\n    controls,\n    addControl: (control: ControlItem) => {\n      control.id = String(Math.random());\n      setControls(ctrls => {\n        // control.id = control.id ?? String(ctrls.length);\n        return [...ctrls, control];\n      });\n      return control;\n    },\n    removeControl: (ctrl: ControlItem) => {\n      setControls(ctrls => ctrls.filter(c => c.id !== ctrl.id));\n    },\n  };\n\n  return (\n    <ControlsContext.Provider value={context}>\n      {children}\n    </ControlsContext.Provider>\n  );\n};\n\nexport function withControls(CanvasEl: typeof R3FCanvas) {\n  return ({ children, ...props }: any) => (\n    <ControlsContext.Consumer>\n      {value => (\n        <CanvasEl {...props}>\n          <ControlsContext.Provider value={value}>\n            {children}\n          </ControlsContext.Provider>\n        </CanvasEl>\n      )}\n    </ControlsContext.Consumer>\n  );\n}\n\nexport const Canvas = withControls(R3FCanvas);\n","import { Dispatch, SetStateAction, MouseEvent } from 'react';\nimport { SpringConfig } from '@react-spring/three';\n\nexport const DEFAULT_GROUP = 'DEFAULT_GROUP';\n\nexport type ControlItem = {\n  id: string;\n  name: string;\n  value: any;\n  options: ControlOptions;\n};\n\nexport enum ControlType {\n  NUMBER = 'number',\n  STRING = 'string',\n  BUTTON = 'button',\n  BOOLEAN = 'boolean',\n  SELECT = 'select',\n  COLOR = 'color',\n  XYPAD = 'xypad',\n  FILE = 'file',\n  CUSTOM = 'custom',\n}\n\nexport type ControlComponentProps<T> = ControlItem & {\n  setValue(value: any): void;\n  options: T;\n};\n\nexport type ControlOptionsBase = {\n  /** Unique id for control */\n  id?: string;\n  /* The control type */\n  type: ControlType | string;\n  /** Default value */\n  value?: any;\n  /* Return useSpring instead of useState */\n  spring?: boolean | SpringConfig;\n  /* Group this control */\n  group?: string;\n  /* Use your own state */\n  state?: [any, Dispatch<SetStateAction<any>>];\n  /* onChange callback */\n  onChange?(value: any): void;\n};\n\nexport type ControlOptionsNumber = {\n  type: ControlType.NUMBER | 'number';\n  /* Minimum value */\n  min?: number;\n  /* Maximum value */\n  max?: number;\n  /* Initial value */\n  value?: number;\n  /* Slider distance */\n  distance?: number;\n  /* Scrub value in both directions */\n  scrub?: boolean;\n};\n\nexport type ControlOptionsString = {\n  type: ControlType.STRING | 'string';\n  /* Initial value */\n  value?: string;\n};\n\nexport type ControlOptionsFile = {\n  type: ControlType.FILE | 'file';\n  /* Initial value */\n  value?: string;\n  /** Loader */\n  loader?: {\n    load(url: string): any;\n  };\n};\n\nexport type ControlOptionsButton = {\n  type: ControlType.BUTTON | 'button';\n  /* Fired on button click */\n  onClick?(e: MouseEvent<HTMLButtonElement>): any;\n};\n\nexport type ControlOptionsBoolean = {\n  type: ControlType.BOOLEAN | 'boolean';\n  value?: boolean;\n};\n\nexport type ControlOptionsSelect = {\n  type: ControlType.SELECT | 'select';\n  /* List of items to select from */\n  items: string[];\n  /* Initial value */\n  value?: string;\n};\n\nexport type ControlOptionsColor = {\n  type: ControlType.COLOR | 'color';\n  /* Initial value as HEX code */\n  value?: string;\n  /* Show picker as inline */\n  inline?: boolean;\n  /* What kind of picker. Default Chrome */\n  picker?:\n    | 'chrome'\n    | 'sketch'\n    | 'hue'\n    | 'alpha'\n    | 'block'\n    | 'github'\n    | 'twitter'\n    | 'circle'\n    | 'material'\n    | 'compact'\n    | 'slider'\n    | 'swatches';\n  /* Disable alpha */\n  disableAlpha?: boolean;\n  /* Custom set of colors */\n  colors?: string[];\n};\n\nexport type ControlOptionsXYPad = {\n  type: ControlType.XYPAD | 'xypad';\n  /* Initial value as { x, y } object */\n  value?: { x: number; y: number };\n  /* Pad drag distance */\n  distance?: number;\n  /* Scrub value in both directions */\n  scrub?: boolean;\n};\n\nexport type ControlOptionsCustom = {\n  type: ControlType.CUSTOM | 'custom';\n  /* Custom React component */\n  component?: any;\n};\n\nexport type ControlOptions = ControlOptionsBase &\n  (\n    | ControlOptionsCustom\n    | ControlOptionsNumber\n    | ControlOptionsBoolean\n    | ControlOptionsString\n    | ControlOptionsButton\n    | ControlOptionsColor\n    | ControlOptionsSelect\n    | ControlOptionsFile\n    | ControlOptionsXYPad\n  );\n","import { ControlOptions, ControlType } from './types';\nimport * as THREE from 'three';\n\nexport const defaultOptions: ControlOptions = {\n  type: ControlType.NUMBER,\n  value: 0,\n};\n\nexport const defaultValue = (options: ControlOptions) => {\n  if (options.hasOwnProperty('value')) {\n    return options.value;\n  }\n\n  switch (options.type) {\n    case ControlType.NUMBER:\n      return 0;\n    case ControlType.COLOR:\n      return '#ff0000';\n    case ControlType.STRING:\n      return '';\n    case ControlType.SELECT:\n      return (options.items || [''])[0];\n    case ControlType.BOOLEAN:\n      return false;\n    case ControlType.FILE:\n      return new THREE.FileLoader();\n    case ControlType.XYPAD:\n      return { x: 0, y: 0 };\n  }\n\n  return undefined;\n};\n\nexport const clamp = (num: number, clamp: number, higher?: number) =>\n  higher !== undefined\n    ? Math.min(Math.max(num, clamp), higher)\n    : Math.min(num, clamp);\n\nexport const map = (\n  value: number,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => ((value - x1) * (y2 - x2)) / (y1 - x1) + x2;\n","import { useState } from 'react';\n\nexport function useLocalStorage(key: string, initialValue: any) {\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.log(error);\n      return initialValue;\n    }\n  });\n\n  const setValue = (value: any) => {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n","import React from 'react';\nimport styled from 'styled-components';\n\ntype SCProps = {\n  stack?: boolean;\n  flexLabel?: boolean;\n};\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 8px 0;\n`;\n\nconst Label = styled.label<SCProps>`\n  display: flex;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n  width: 56px;\n  user-select: none;\n  ${props => (props.flexLabel === true ? 'flex: 1;' : '')}\n`;\n\nconst Content = styled.div<SCProps>`\n  display: flex;\n  ${props => (props.flexLabel !== true ? 'flex: 1;' : '')}\n  justify-content: flex-end;\n  padding: 0 8px;\n`;\n\nconst Value = styled.div<SCProps>`\n  display: flex;\n  font-family: sans-serif;\n  white-space: nowrap;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.75);\n  justify-content: flex-end;\n  ${props => (props.stack ? 'flex: 1;' : '')}\n  ${props => (props.stack ? '' : 'width: 42px;')}\n`;\n\ntype BaseControlProps = {\n  label?: string;\n  flexLabel?: boolean;\n  value?: string;\n  children?: any;\n  stack?: boolean;\n  htmlFor?: any;\n};\n\nexport function BaseControl({\n  htmlFor,\n  label,\n  flexLabel,\n  value,\n  stack,\n  children,\n}: BaseControlProps) {\n  if (stack) {\n    return (\n      <div>\n        <Row>\n          <Label flexLabel={flexLabel}>{label}</Label>\n          <Value stack flexLabel={flexLabel}>\n            {value}\n          </Value>\n        </Row>\n        {children}\n      </div>\n    );\n  }\n\n  return (\n    <Row>\n      <Label flexLabel={flexLabel} htmlFor={htmlFor}>\n        {label}\n      </Label>\n      <Content flexLabel={flexLabel}>{children}</Content>\n      {typeof value !== 'undefined' && <Value>{value}</Value>}\n    </Row>\n  );\n}\n","import styled from 'styled-components';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { clamp, map } from '../../utils';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsNumber } from '../../types';\n\nconst InputRange = styled.input`\n  -webkit-appearance: none;\n  width: 100%;\n  background: transparent;\n  display: inline-block;\n\n  &:focus {\n    outline: none;\n  }\n\n  &::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 12px;\n    cursor: pointer;\n    background: rgba(0, 0, 0, 0.045);\n    border-radius: 10px;\n  }\n\n  &::-webkit-slider-thumb {\n    border: none;\n    height: 20px;\n    width: 20px;\n    border-radius: 50%;\n    background: #ffffff;\n    cursor: pointer;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.22);\n    -webkit-appearance: none;\n    margin-top: -4px;\n  }\n\n  &:focus::-webkit-slider-runnable-track {\n    outline: none;\n  }\n`;\n\nconst PRECISION = 300;\nconst CENTER = PRECISION / 2;\n\nexport const NumberControl = ({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsNumber>) => {\n  const ref = useRef<HTMLInputElement | null>(null);\n  const stage = useRef(null);\n  const {\n    min = options.scrub ? -Infinity : 0,\n    max = options.scrub ? Infinity : Math.PI,\n  } = options;\n\n  const distance = options.distance ?? options.scrub ? 2 : max - min;\n\n  const [val, setVal] = useState(\n    options.scrub ? CENTER : map(value, min, max, 0, PRECISION)\n  );\n\n  const handleChange = useCallback(() => {\n    if (options.scrub) {\n      setVal(CENTER);\n      stage.current = null;\n    }\n  }, [options.scrub]);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (el) {\n      el.addEventListener('change', handleChange);\n    }\n    return () => {\n      if (el) {\n        el.removeEventListener('change', handleChange);\n      }\n    };\n  }, [handleChange, ref]);\n\n  return (\n    <BaseControl label={name} value={(value || 0).toFixed(2)}>\n      <InputRange\n        ref={ref}\n        type=\"range\"\n        value={val}\n        min={0}\n        max={PRECISION}\n        onChange={e => {\n          const num = Number(e.target.value);\n          setVal(num);\n          if (stage.current === null) {\n            stage.current = value;\n          }\n          const cvalue =\n            (options.scrub ? (stage as any).current : 0) +\n            map(\n              num - (options.scrub ? CENTER : 0),\n              0,\n              PRECISION,\n              options.scrub ? 0 : min,\n              options.scrub ? distance * 2 : max\n            );\n          setValue(clamp(cvalue, min, max));\n        }}\n      />\n    </BaseControl>\n  );\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { BaseControl } from \"./base-control\";\nimport { ControlComponentProps, ControlOptionsBoolean } from \"../../types\";\n\nconst FakeCheckbox = styled.label`\n  height: 16px;\n  width: 16px;\n  border: 2px solid rgba(0, 0, 0, 0.065);\n  border-radius: 4px;\n  position: relative;\n  margin-top: -1px;\n  transition: ease-in-out 125ms;\n  transition-property: background-color, border-color;\n`;\n\nconst Checkbox = styled.input`\n  opacity: 0;\n  margin-right: -15px;\n  & + ${FakeCheckbox}:after {\n    position: absolute;\n    content: \"\";\n    display: inline-block;\n    height: 4px;\n    width: 8px;\n    border-left: 2px solid;\n    border-bottom: 2px solid;\n    left: 3px;\n    top: 4px;\n    opacity: 0;\n    transform: translate(0px, 2px) rotate(-45deg);\n    transition: ease-in-out 125ms;\n    transition-property: opacity, transform;\n  }\n  &:checked + ${FakeCheckbox}:after {\n    opacity: 1;\n    transform: translate(0px, 0px) rotate(-45deg);\n  }\n  &:checked + ${FakeCheckbox} {\n    background: rgba(0, 0, 0, 0.045);\n    border-color: rgba(0, 0, 0, 0.085);\n  }\n`;\n\nexport function BooleanControl({\n  id,\n  name,\n  value,\n  setValue\n}: ControlComponentProps<ControlOptionsBoolean>) {\n  const htmlFor = `Control${id}`;\n  return (\n    <BaseControl flexLabel label={name} htmlFor={htmlFor}>\n      <Checkbox\n        id={htmlFor}\n        type=\"checkbox\"\n        checked={value}\n        onChange={(e) => setValue(e.currentTarget.checked)}\n      />\n      <FakeCheckbox htmlFor={htmlFor} />\n    </BaseControl>\n  );\n}\n","import React, { MouseEvent } from 'react';\nimport styled from 'styled-components';\nimport { ControlComponentProps, ControlOptionsButton } from '../../types';\n\nconst Button = styled.button`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.045);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport function ButtonControl({\n  name,\n  options,\n}: ControlComponentProps<ControlOptionsButton>) {\n  return (\n    <div style={{ paddingTop: 8, paddingBottom: 8 }}>\n      <Button\n        onClick={(e: MouseEvent<HTMLButtonElement>) => {\n          if (options.onClick) {\n            options.onClick(e);\n          }\n        }}\n      >\n        {name}\n      </Button>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport {\n  AlphaPicker,\n  BlockPicker,\n  ChromePicker,\n  CirclePicker,\n  CompactPicker,\n  GithubPicker,\n  HuePicker,\n  MaterialPicker,\n  SketchPicker,\n  SliderPicker,\n  SwatchesPicker,\n  TwitterPicker,\n} from 'react-color';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsColor } from '../../types';\n\nconst ColorPicker = styled.div`\n  position: relative;\n\n  > div {\n    box-sizing: border-box !important;\n  }\n`;\n\nconst ColorBox = styled.div`\n  width: 32px;\n  height: 16px;\n  border: 2px solid white;\n  box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.3);\n  cursor: pointer;\n`;\n\nconst Picker = styled.div<{ hidden: boolean }>`\n  position: absolute;\n  top: 24px;\n  right: 0px;\n  z-index: 100;\n`;\n\nexport function ColorControl({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsColor>) {\n  const { inline = false, picker = 'chrome' } = options;\n  const [open, setOpen] = useState(false);\n  const pickerRef = useRef<HTMLDivElement>();\n  const handleClick = (e: any) => {\n    if (pickerRef.current && !pickerRef.current.contains(e.target)) {\n      setOpen(false);\n    }\n  };\n\n  useEffect(() => {\n    document.body.addEventListener('click', handleClick);\n    return () => {\n      document.body.removeEventListener('click', handleClick);\n    };\n  }, []);\n\n  const pickerProps: any = {\n    color: value,\n    onChange: (color: any) => setValue(color.rgb),\n    disableAlpha: options.disableAlpha,\n    colors: options.colors,\n  };\n\n  let PickerElement: any = ChromePicker;\n\n  switch (picker) {\n    case 'alpha':\n      PickerElement = AlphaPicker;\n      break;\n    case 'block':\n      PickerElement = BlockPicker;\n      break;\n    case 'circle':\n      PickerElement = CirclePicker;\n      break;\n    case 'compact':\n      PickerElement = CompactPicker;\n      break;\n    case 'github':\n      PickerElement = GithubPicker;\n      break;\n    case 'hue':\n      PickerElement = HuePicker;\n      break;\n    case 'material':\n      PickerElement = MaterialPicker;\n      break;\n    case 'sketch':\n      PickerElement = SketchPicker;\n      pickerProps.presetColors = options.colors;\n      break;\n    case 'slider':\n      PickerElement = SliderPicker;\n      break;\n    case 'swatches':\n      PickerElement = SwatchesPicker;\n      break;\n    case 'twitter':\n      PickerElement = TwitterPicker;\n      break;\n  }\n\n  return (\n    <BaseControl stack={inline} label={name} flexLabel>\n      <ColorPicker>\n        {inline ? (\n          <PickerElement\n            {...pickerProps}\n            triangle={inline ? 'hide' : undefined}\n            width={268}\n          />\n        ) : (\n          <>\n            <ColorBox\n              style={{ backgroundColor: value }}\n              onClick={() => setOpen(lastValue => !lastValue)}\n            />\n            <Picker hidden={open !== true} ref={pickerRef as any}>\n              <PickerElement {...pickerProps} />\n            </Picker>\n          </>\n        )}\n      </ColorPicker>\n    </BaseControl>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsSelect } from '../../types';\n\nconst Select = styled.select`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport function SelectControl({\n  name,\n  setValue,\n  value,\n  options,\n}: ControlComponentProps<ControlOptionsSelect>) {\n  const { items = [] } = options;\n  return (\n    <BaseControl label={name}>\n      <Select value={value} onChange={e => setValue(e.currentTarget.value)}>\n        {items.map((item: string, i: number) => (\n          <option key={i}>{item}</option>\n        ))}\n      </Select>\n    </BaseControl>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsString } from '../../types';\n\nconst Input = styled.input`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport const StringControl = React.memo(\n  ({ name, setValue, value }: ControlComponentProps<ControlOptionsString>) => {\n    return (\n      <BaseControl label={name}>\n        <Input value={value} onChange={e => setValue(e.target.value)} />\n      </BaseControl>\n    );\n  }\n);\n","import React, { useRef } from 'react';\nimport { animated, useSpring, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { clamp, map } from '../../utils';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsXYPad } from '../../types';\n\n// When to just show 0 instead of 0.000000012333\nconst THRESHOLD = 0.00001;\n\nexport const XYPadControl = ({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsXYPad>) => {\n  const stage = useRef(null);\n  const { distance = 1, scrub = false } = options;\n  const [ref, { width, height }] = useMeasure();\n\n  const [cursor, setCursor] = useSpring(\n    () => ({\n      from: {\n        x: value.x,\n        y: value.y,\n      },\n\n      onChange(value: any, b: any) {\n        const clampMx = b.key === 'x' ? width : height;\n        const v =\n          clamp(map(value, 0, clampMx / 2, 0, distance), -distance, distance) ||\n          0;\n        if (!scrub) {\n          setValue((prev: any) => ({\n            ...prev,\n            [b.key]: v < THRESHOLD && v > -THRESHOLD ? 0 : v,\n          }));\n        }\n      },\n    }),\n    [width, height]\n  ) as any;\n\n  const bind = useDrag(({ down, movement }) => {\n    if (down && !stage.current) {\n      stage.current = value;\n    } else if (!down) {\n      stage.current = null;\n    }\n\n    setCursor({ x: down ? movement[0] : 0, y: down ? movement[1] : 0 });\n\n    if (scrub) {\n      if (down) {\n        setValue(() => ({\n          x:\n            (stage as any).current.x +\n            map(movement[0], 0, width / 2, 0, distance),\n          y:\n            (stage as any).current.y +\n            map(movement[1], 0, height / 2, 0, distance),\n        }));\n      } else {\n        stage.current = value;\n      }\n    }\n  });\n\n  const x = cursor.x.to((n: number) => clamp(n + width / 2, 0, width));\n  const y = cursor.y.to((n: number) => clamp(n + height / 2, 0, height));\n\n  return (\n    <BaseControl\n      stack\n      label={name}\n      value={`x: ${value.x.toFixed(1)}, y: ${value.y.toFixed(1)}`}\n    >\n      <animated.svg\n        ref={ref as any}\n        style={{\n          userSelect: 'none',\n          borderRadius: 8,\n          border: '1px solid #f0f0f0',\n        }}\n        width=\"100%\"\n        height={200}\n        xmlns=\"http://www.w3.org/2000/svg\"\n        {...bind()}\n      >\n        <rect fill=\"rgb(250, 250, 250)\" width=\"100%\" height=\"100%\" />\n        <animated.line x1={x} x2={x} y1={0} y2=\"100%\" stroke=\"#ccc\" />\n        <animated.line x1={0} x2=\"100%\" y1={y} y2={y} stroke=\"#ccc\" />\n        <animated.g\n          style={{\n            transform: to([x, y], (x, y) => `translate(${x}px, ${y}px)`),\n          }}\n        >\n          <circle r={8} fill=\"#ccc\" />\n          <circle r={4} fill=\"#aaa\" />\n        </animated.g>\n      </animated.svg>\n    </BaseControl>\n  );\n};\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsFile } from '../../types';\nimport * as THREE from 'three';\n\nconst FileInput = styled.input`\n  width: 100%;\n`;\n\nexport const FileControl = ({\n  name,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsFile>) => {\n  return (\n    <BaseControl label={name}>\n      <FileInput\n        type=\"file\"\n        onChange={e => {\n          const loader = options.loader ?? new THREE.FileLoader();\n          if ((loader as any).setCrossOrigin) {\n            (loader as THREE.TextureLoader).setCrossOrigin('');\n          }\n          const file = e.currentTarget.files && e.currentTarget.files[0];\n          const texture = loader.load(URL.createObjectURL(file));\n          setValue(texture);\n        }}\n      />\n    </BaseControl>\n  );\n};\n","import React, { useContext, useEffect, useState } from 'react';\nimport { ControlsContext } from '../contexts/controls-context';\nimport {\n  ControlType,\n  ControlOptions,\n  ControlComponentProps,\n  ControlOptionsCustom,\n} from '../types';\nimport { NumberControl } from './controls/number-control';\nimport { BooleanControl } from './controls/boolean-control';\nimport { BaseControl } from './controls/base-control';\nimport { ButtonControl } from './controls/button-control';\nimport { ColorControl } from './controls/color-control';\nimport { SelectControl } from './controls/select-control';\nimport { StringControl } from './controls/string-control';\nimport { XYPadControl } from './controls/xy-pad-control';\nimport { FileControl } from './controls/file-control';\n\nconst ControlComponents = {\n  [ControlType.NUMBER]: NumberControl,\n  [ControlType.BOOLEAN]: BooleanControl,\n  [ControlType.SELECT]: SelectControl,\n  [ControlType.COLOR]: ColorControl,\n  [ControlType.STRING]: StringControl,\n  [ControlType.BUTTON]: ButtonControl,\n  [ControlType.FILE]: FileControl,\n  [ControlType.XYPAD]: XYPadControl,\n};\n\nconst Noop = ({ name, options }: any) => (\n  <BaseControl label={name}>\"{options.type}\" not found</BaseControl>\n);\n\nexport const ControlItem = ({\n  name,\n  id,\n  value: defaultValue,\n  options,\n}: ControlComponentProps<ControlOptions>) => {\n  const context = useContext(ControlsContext);\n\n  const [value, setValue] = useState(\n    context.values.current && context.values.current.has(id)\n      ? context.values.current.get(id)\n      : defaultValue\n  );\n\n  useEffect(() => {\n    context.values.current!.set(id, value);\n  }, [context.values, id, value]);\n\n  useEffect(() => {\n    context.gui.current!.set(id, setValue);\n  }, [context.gui, id]);\n\n  const Component =\n    (options as ControlOptionsCustom).component ??\n    (ControlComponents as any)[options.type ?? ControlType.NUMBER] ??\n    Noop;\n\n  return (\n    <Component\n      id={id}\n      name={name}\n      value={value}\n      setValue={(newValue: any) => {\n        context.gui.current?.get(id)?.(newValue);\n        context.state.current?.get(id)?.(newValue);\n      }}\n      options={options}\n    />\n  );\n};\n","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport { ControlItem } from './control-item';\n\nconst Heading = styled.h2<{ open: boolean }>`\n  display: block;\n  font-family: sans-serif;\n  font-size: 13px;\n  font-weight: bold;\n  padding-left: 16px;\n  cursor: pointer;\n  position: relative;\n  user-select: none;\n\n  &:before,\n  &:after {\n    content: '';\n    position: absolute;\n    top: 8px;\n    right: 16px;\n    width: 12px;\n    height: 2px;\n    background-color: #333;\n    /* transition: transform 0.25s ease-out; */\n  }\n  &:before {\n    transform: rotate(${props => (props.open ? 0 : 90)}deg);\n  }\n\n  &:after {\n    transform: rotate(${props => (props.open ? 0 : 180)}deg);\n  }\n`;\n\nconst Container = styled.div<{ open: boolean; bg: boolean }>`\n  background: ${props => (props.bg ? '#f9f9f9' : '#fff')};\n  padding: 16px;\n  display: ${props => (props.open ? 'block' : 'none')};\n  margin-bottom: 8px;\n`;\n\nexport const ControlGroup = ({ title, controls, options = {} }: any) => {\n  const [open, setOpen] = useState(!options.defaultClosed ?? true);\n  const isDefault = title !== 'DEFAULT_GROUP';\n  return (\n    <div>\n      {isDefault && (\n        <Heading open={open} onClick={() => setOpen(o => !o)}>\n          {title}\n        </Heading>\n      )}\n      <Container open={open} bg={isDefault}>\n        {Array.from(controls).map((control: any) => (\n          <ControlItem key={`${control.id}_${control.name}`} {...control} />\n        ))}\n      </Container>\n    </div>\n  );\n};\n","import React, { useContext } from 'react';\nimport { ControlsProvider, Canvas } from './controls-provider';\nimport styled from 'styled-components';\nimport { animated, useSpring, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { clamp } from '../utils';\nimport { DEFAULT_GROUP } from '../types';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { useLocalStorage } from '../hooks/use-local-storage';\nimport { ControlGroup } from './control-group';\n\nconst mq = `@media only screen and (max-width: 600px)`;\n\ninterface FloatProps {\n  'data-width': number;\n  'data-anchor': ControlsAnchor | string;\n}\n\nexport enum ControlsAnchor {\n  TOP_LEFT = 'top_left',\n  TOP_RIGHT = 'top_right',\n  BOTTOM_LEFT = 'bottom_left',\n  BOTTOM_RIGHT = 'bottom_right',\n}\n\nexport interface ControlsProps {\n  /**\n   * Title to show on the controls\n   */\n  title?: string;\n  /**\n   * Collapsed by default\n   */\n  collapsed?: boolean;\n  /**\n   * Array of group names as strings\n   */\n  defaultClosedGroups?: string[];\n  /**\n   * Defaults to 300\n   */\n  width?: number;\n  /**\n   * Anchor point\n   */\n  anchor?:\n    | ControlsAnchor\n    | 'top_left'\n    | 'bottom_left'\n    | 'top_right'\n    | 'bottom_right';\n  /**\n   * Styles\n   */\n  style?: any;\n}\n\nfunction posProps(positions: ControlsAnchor[]) {\n  return function posPropsFn(props: any) {\n    return positions.includes(props['data-anchor']) ? '16px' : 'auto';\n  };\n}\n\nconst Float = styled(animated.div)<FloatProps>`\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  top: ${posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.TOP_RIGHT])};\n  right: ${posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.TOP_RIGHT])};\n  bottom: ${posProps([\n    ControlsAnchor.BOTTOM_RIGHT,\n    ControlsAnchor.BOTTOM_LEFT,\n  ])};\n  left: ${posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT])};\n  width: ${props => props['data-width']}px;\n  border-radius: 16px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);\n\n  ${mq} {\n    transform: none !important;\n    flex-direction: column-reverse;\n    top: auto;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    width: auto;\n  }\n`;\n\nconst Header = styled(animated.div)<{ 'data-collapsed': boolean }>`\n  display: flex;\n  align-items: center;\n  position: relative;\n  padding-left: 16px;\n  padding-right: 16px;\n  height: 42px;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: #fff;\n  cursor: move;\n  cursor: grab;\n  user-select: none;\n  background-color: #000;\n  border-top-left-radius: 8px;\n  border-top-right-radius: 8px;\n  border-bottom-left-radius: ${props => (props['data-collapsed'] ? 0 : 8)}px;\n  border-bottom-right-radius: ${props => (props['data-collapsed'] ? 0 : 8)}px;\n  box-shadow: 0 0 14px 0 rgba(0, 0, 0, 0.14);\n  ${mq} {\n    border-top-left-radius: 0px;\n    border-top-right-radius: 0px;\n    border-bottom-left-radius: 0px;\n    border-bottom-right-radius: 0px;\n  }\n`;\n\nconst CollapseIcon = styled.div<{ collapsed: boolean }>`\n  width: 30px;\n  height: 18px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: auto;\n  cursor: pointer;\n  &:after {\n    content: '';\n    display: block;\n    height: 3px;\n    width: 16px;\n    background-color: white;\n  }\n  ${mq} {\n    &:before {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n    }\n  }\n`;\n\nconst Items = styled(animated.div)`\n  padding-bottom: 8px;\n  overflow-y: auto;\n  max-height: calc(100vh - 42px);\n`;\n\nconst groupByGroup = (items: any): any => {\n  return Array.from(items).reduce((acc: any, item: any) => {\n    const groupName = item?.options?.group || DEFAULT_GROUP;\n    acc[groupName] = acc[groupName] || [];\n    acc[groupName].push(item);\n    return acc;\n  }, {} as { [key: string]: any });\n};\n\ninterface ControlsFn {\n  (props: ControlsProps): JSX.Element;\n  Provider: typeof ControlsProvider;\n  Canvas: typeof Canvas;\n}\n\nexport const Controls: ControlsFn = (props: ControlsProps) => {\n  const {\n    title = 'react-three-gui',\n    defaultClosedGroups = [],\n    width = 300,\n    style = {},\n    anchor = ControlsAnchor.TOP_RIGHT,\n  } = props;\n  const { controls } = useContext(ControlsContext);\n  const [collapsed, setCollapsed] = useLocalStorage(\n    'REACT_THREE_GUI__COLLAPSED',\n    props.collapsed\n  );\n  const [position, setPosition] = useLocalStorage(\n    `REACT_THREE_GUI__${anchor}`,\n    [0, 0]\n  );\n  const [ref, bounds] = useMeasure();\n  const [{ pos }, setPos] = useSpring(() => ({\n    pos: position,\n    onRest({ value }) {\n      setPosition(value);\n    },\n  }));\n  const left = [ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT].includes(\n    anchor as any\n  );\n  const top = [ControlsAnchor.TOP_RIGHT, ControlsAnchor.TOP_LEFT].includes(\n    anchor as any\n  );\n  const bind = useDrag(\n    ({\n      movement,\n      memo = pos\n        ? (pos as any).getValue\n          ? (pos as any).getValue()\n          : (pos as any).get()\n        : 0,\n    }) => {\n      const [x, y] = [movement[0] + memo[0], movement[1] + memo[1]];\n      setPos({\n        pos: [\n          left\n            ? clamp(x, 1, window.innerWidth - width - 32)\n            : clamp(x, -window.innerWidth + width + 32, 1),\n          top\n            ? clamp(y, 1, window.innerHeight)\n            : clamp(y, -window.innerHeight + bounds.height + 32, 1),\n        ],\n      });\n      return memo;\n    }\n  );\n\n  const getGroupOptions = (groupName: string): any => {\n    return {\n      defaultClosed: defaultClosedGroups?.includes(groupName) ?? false,\n    };\n  };\n\n  const groups = groupByGroup(controls);\n\n  return (\n    <Float\n      data-width={width}\n      data-anchor={anchor}\n      ref={ref}\n      style={{\n        ...style,\n        transform: to(\n          [pos] as any,\n          ([x, y]) => `translate3d(${x}px,${y}px,0)` as any\n        ),\n      }}\n    >\n      <Header data-collapsed={collapsed} {...bind()}>\n        {title}\n        <CollapseIcon\n          collapsed={collapsed}\n          onClick={() => setCollapsed((c: boolean) => !c)}\n        />\n      </Header>\n      <Items\n        hidden={!collapsed}\n        style={{\n          maxHeight: top\n            ? to([pos] as any, ([_, y]) => `calc(100vh - ${y + 92}px)` as any)\n            : undefined,\n        }}\n      >\n        {Object.entries(groups).map(([groupName, items]: any) => (\n          <ControlGroup\n            key={groupName}\n            title={groupName}\n            controls={items}\n            options={getGroupOptions(groupName)}\n          />\n        ))}\n      </Items>\n    </Float>\n  );\n};\n\nControls.Provider = ControlsProvider;\nControls.Canvas = Canvas;\n","import { useState, useEffect, useContext } from 'react';\nimport { useSpring } from '@react-spring/three';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { ControlOptions, ControlItem } from '../types';\nimport { defaultOptions, defaultValue } from '../utils';\n\nexport const useControl = (\n  name: string,\n  options: ControlOptions = defaultOptions\n) => {\n  const context = useContext(ControlsContext);\n  const [id, setId] = useState<string | null>(null);\n  let [value, setValue] = useState(defaultValue(options));\n\n  const [spring, setSpring] = useSpring(() => ({\n    value,\n    config: typeof options.spring === 'object' ? options.spring : undefined,\n  }));\n  const setSpringValue = (springValue: any) =>\n    setSpring({ value: springValue });\n\n  if (options.state) {\n    value = options.state[0];\n    setValue = options.state[1];\n  }\n\n  useEffect(() => {\n    if (context.state.current && id) {\n      if (options.spring) {\n        context.state.current.set(id, setSpringValue);\n      } else {\n        context.state.current.set(id, setValue);\n      }\n    }\n  }, [context.state, id]);\n\n  useEffect(() => {\n    const ctrl = context.addControl({\n      id: options.id,\n      name,\n      value,\n      options,\n    } as ControlItem);\n    setId(ctrl.id);\n    return () => {\n      context.removeControl(ctrl);\n    };\n  }, []);\n\n  useEffect(() => {\n    options.spring && void setSpring({ value });\n    options.onChange && void options.onChange(value);\n  }, [options, setSpring, value]);\n\n  if (options.spring) {\n    return spring.value;\n  }\n\n  return value;\n};\n"],"names":["ControlsContext","createContext","values","current","Map","gui","state","controls","addControl","control","removeControl","ControlsProvider","children","useState","setControls","useRef","context","id","String","Math","random","ctrls","ctrl","filter","c","React","Provider","value","withControls","CanvasEl","props","Consumer","Canvas","R3FCanvas","DEFAULT_GROUP","ControlType","defaultOptions","type","NUMBER","defaultValue","options","hasOwnProperty","COLOR","STRING","SELECT","items","BOOLEAN","FILE","THREE","XYPAD","x","y","undefined","clamp","num","higher","min","max","map","x1","y1","x2","y2","useLocalStorage","key","initialValue","item","window","localStorage","getItem","JSON","parse","error","console","log","storedValue","setStoredValue","setValue","valueToStore","Function","setItem","stringify","Row","styled","div","Label","label","flexLabel","Content","Value","stack","BaseControl","htmlFor","InputRange","input","PRECISION","CENTER","NumberControl","name","ref","stage","scrub","Infinity","PI","distance","val","setVal","handleChange","useCallback","useEffect","el","addEventListener","removeEventListener","toFixed","onChange","e","Number","target","cvalue","FakeCheckbox","Checkbox","BooleanControl","checked","currentTarget","Button","button","ButtonControl","style","paddingTop","paddingBottom","onClick","ColorPicker","ColorBox","Picker","ColorControl","inline","picker","open","setOpen","pickerRef","handleClick","contains","document","body","pickerProps","color","rgb","disableAlpha","colors","PickerElement","ChromePicker","AlphaPicker","BlockPicker","CirclePicker","CompactPicker","GithubPicker","HuePicker","MaterialPicker","SketchPicker","presetColors","SliderPicker","SwatchesPicker","TwitterPicker","triangle","width","backgroundColor","lastValue","hidden","Select","select","SelectControl","i","Input","StringControl","memo","THRESHOLD","XYPadControl","useMeasure","height","useSpring","from","b","clampMx","v","prev","cursor","setCursor","bind","useDrag","down","movement","to","n","animated","svg","userSelect","borderRadius","border","xmlns","fill","line","stroke","g","transform","r","FileInput","FileControl","loader","setCrossOrigin","file","files","texture","load","URL","createObjectURL","ControlComponents","BUTTON","Noop","ControlItem","useContext","has","get","set","Component","component","newValue","Heading","h2","Container","bg","ControlGroup","title","defaultClosed","isDefault","o","Array","mq","ControlsAnchor","posProps","positions","posPropsFn","includes","Float","TOP_LEFT","TOP_RIGHT","BOTTOM_RIGHT","BOTTOM_LEFT","Header","CollapseIcon","Items","groupByGroup","reduce","acc","groupName","group","push","Controls","defaultClosedGroups","anchor","collapsed","setCollapsed","position","setPosition","bounds","pos","onRest","setPos","left","top","getValue","innerWidth","innerHeight","getGroupOptions","groups","maxHeight","Object","entries","useControl","setId","config","spring","setSpring","setSpringValue","springValue"],"mappings":"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"}