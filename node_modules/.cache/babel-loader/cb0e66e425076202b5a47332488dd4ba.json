{"ast":null,"code":"import React, { createContext, useState, useRef, useCallback, useEffect, useContext } from 'react';\nimport { Canvas as Canvas$1 } from 'react-three-fiber';\nimport styled from 'styled-components';\nimport { useSpring, animated, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { FileLoader } from 'three';\nimport { ChromePicker, TwitterPicker, SwatchesPicker, SliderPicker, SketchPicker, MaterialPicker, HuePicker, GithubPicker, CompactPicker, CirclePicker, BlockPicker, AlphaPicker } from 'react-color';\nimport { useSpring as useSpring$1 } from '@react-spring/three';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _taggedTemplateLiteralLoose(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  strings.raw = raw;\n  return strings;\n}\n\nvar ControlsContext = /*#__PURE__*/createContext({\n  values: {\n    current: /*#__PURE__*/new Map()\n  },\n  gui: {\n    current: /*#__PURE__*/new Map()\n  },\n  state: {\n    current: /*#__PURE__*/new Map()\n  },\n  controls: [],\n  addControl: function addControl(control) {\n    return control;\n  },\n  removeControl: function removeControl() {}\n});\n\nvar ControlsProvider = function ControlsProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState([]),\n      controls = _useState[0],\n      setControls = _useState[1]; // Persist values between reloads\n\n\n  var values = useRef(new Map()); // GUI control state setters\n\n  var gui = useRef(new Map()); // useControl state setters\n\n  var state = useRef(new Map());\n  var context = {\n    values: values,\n    gui: gui,\n    state: state,\n    controls: controls,\n    addControl: function addControl(control) {\n      control.id = String(Math.random());\n      setControls(function (ctrls) {\n        // control.id = control.id ?? String(ctrls.length);\n        return [].concat(ctrls, [control]);\n      });\n      return control;\n    },\n    removeControl: function removeControl(ctrl) {\n      setControls(function (ctrls) {\n        return ctrls.filter(function (c) {\n          return c.id !== ctrl.id;\n        });\n      });\n    }\n  };\n  return React.createElement(ControlsContext.Provider, {\n    value: context\n  }, children);\n};\n\nfunction withControls(CanvasEl) {\n  return function (_ref2) {\n    var children = _ref2.children,\n        props = _objectWithoutPropertiesLoose(_ref2, [\"children\"]);\n\n    return React.createElement(ControlsContext.Consumer, null, function (value) {\n      return React.createElement(CanvasEl, Object.assign({}, props), React.createElement(ControlsContext.Provider, {\n        value: value\n      }, children));\n    });\n  };\n}\n\nvar Canvas = /*#__PURE__*/withControls(Canvas$1);\nvar DEFAULT_GROUP = 'DEFAULT_GROUP';\nvar ControlType;\n\n(function (ControlType) {\n  ControlType[\"NUMBER\"] = \"number\";\n  ControlType[\"STRING\"] = \"string\";\n  ControlType[\"BUTTON\"] = \"button\";\n  ControlType[\"BOOLEAN\"] = \"boolean\";\n  ControlType[\"SELECT\"] = \"select\";\n  ControlType[\"COLOR\"] = \"color\";\n  ControlType[\"XYPAD\"] = \"xypad\";\n  ControlType[\"FILE\"] = \"file\";\n  ControlType[\"CUSTOM\"] = \"custom\";\n})(ControlType || (ControlType = {}));\n\nvar defaultOptions = {\n  type: ControlType.NUMBER,\n  value: 0\n};\n\nvar defaultValue = function defaultValue(options) {\n  if (options.hasOwnProperty('value')) {\n    return options.value;\n  }\n\n  switch (options.type) {\n    case ControlType.NUMBER:\n      return 0;\n\n    case ControlType.COLOR:\n      return '#ff0000';\n\n    case ControlType.STRING:\n      return '';\n\n    case ControlType.SELECT:\n      return (options.items || [''])[0];\n\n    case ControlType.BOOLEAN:\n      return false;\n\n    case ControlType.FILE:\n      return new FileLoader();\n\n    case ControlType.XYPAD:\n      return {\n        x: 0,\n        y: 0\n      };\n  }\n\n  return undefined;\n};\n\nvar clamp = function clamp(num, _clamp, higher) {\n  return higher !== undefined ? Math.min(Math.max(num, _clamp), higher) : Math.min(num, _clamp);\n};\n\nvar map = function map(value, x1, y1, x2, y2) {\n  return (value - x1) * (y2 - x2) / (y1 - x1) + x2;\n};\n\nfunction useLocalStorage(key, initialValue) {\n  var _useState = useState(function () {\n    try {\n      var item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.log(error);\n      return initialValue;\n    }\n  }),\n      storedValue = _useState[0],\n      setStoredValue = _useState[1];\n\n  var setValue = function setValue(value) {\n    try {\n      var valueToStore = value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  font-family: sans-serif;\\n  white-space: nowrap;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.75);\\n  justify-content: flex-end;\\n  \", \"\\n  \", \"\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  \", \"\\n  justify-content: flex-end;\\n  padding: 0 8px;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n  width: 56px;\\n  user-select: none;\\n  \", \"\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  padding: 8px 0;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Row = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject());\nvar Label = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject2(), function (props) {\n  return props.flexLabel === true ? 'flex: 1;' : '';\n});\nvar Content = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject3(), function (props) {\n  return props.flexLabel !== true ? 'flex: 1;' : '';\n});\nvar Value = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject4(), function (props) {\n  return props.stack ? 'flex: 1;' : '';\n}, function (props) {\n  return props.stack ? '' : 'width: 42px;';\n});\n\nfunction BaseControl(_ref) {\n  var htmlFor = _ref.htmlFor,\n      label = _ref.label,\n      flexLabel = _ref.flexLabel,\n      value = _ref.value,\n      stack = _ref.stack,\n      children = _ref.children;\n\n  if (stack) {\n    return React.createElement(\"div\", null, React.createElement(Row, null, React.createElement(Label, {\n      flexLabel: flexLabel\n    }, label), React.createElement(Value, {\n      stack: true,\n      flexLabel: flexLabel\n    }, value)), children);\n  }\n\n  return React.createElement(Row, null, React.createElement(Label, {\n    flexLabel: flexLabel,\n    htmlFor: htmlFor\n  }, label), React.createElement(Content, {\n    flexLabel: flexLabel\n  }, children), typeof value !== 'undefined' && React.createElement(Value, null, value));\n}\n\nfunction _templateObject$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  -webkit-appearance: none;\\n  width: 100%;\\n  background: transparent;\\n  display: inline-block;\\n\\n  &:focus {\\n    outline: none;\\n  }\\n\\n  &::-webkit-slider-runnable-track {\\n    width: 100%;\\n    height: 12px;\\n    cursor: pointer;\\n    background: rgba(0, 0, 0, 0.045);\\n    border-radius: 10px;\\n  }\\n\\n  &::-webkit-slider-thumb {\\n    border: none;\\n    height: 20px;\\n    width: 20px;\\n    border-radius: 50%;\\n    background: #ffffff;\\n    cursor: pointer;\\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.22);\\n    -webkit-appearance: none;\\n    margin-top: -4px;\\n  }\\n\\n  &:focus::-webkit-slider-runnable-track {\\n    outline: none;\\n  }\\n\"]);\n\n  _templateObject$1 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar InputRange = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject$1());\nvar PRECISION = 300;\nvar CENTER = PRECISION / 2;\n\nvar NumberControl = function NumberControl(_ref) {\n  var _options$distance;\n\n  var name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  var ref = useRef(null);\n  var stage = useRef(null);\n  var _options$min = options.min,\n      min = _options$min === void 0 ? options.scrub ? -Infinity : 0 : _options$min,\n      _options$max = options.max,\n      max = _options$max === void 0 ? options.scrub ? Infinity : Math.PI : _options$max;\n  var distance = ((_options$distance = options.distance) !== null && _options$distance !== void 0 ? _options$distance : options.scrub) ? 2 : max - min;\n\n  var _useState = useState(options.scrub ? CENTER : map(value, min, max, 0, PRECISION)),\n      val = _useState[0],\n      setVal = _useState[1];\n\n  var handleChange = useCallback(function () {\n    if (options.scrub) {\n      setVal(CENTER);\n      stage.current = null;\n    }\n  }, [options.scrub]);\n  useEffect(function () {\n    var el = ref.current;\n\n    if (el) {\n      el.addEventListener('change', handleChange);\n    }\n\n    return function () {\n      if (el) {\n        el.removeEventListener('change', handleChange);\n      }\n    };\n  }, [handleChange, ref]);\n  return React.createElement(BaseControl, {\n    label: name,\n    value: (value || 0).toFixed(2)\n  }, React.createElement(InputRange, {\n    ref: ref,\n    type: \"range\",\n    value: val,\n    min: 0,\n    max: PRECISION,\n    onChange: function onChange(e) {\n      var num = Number(e.target.value);\n      setVal(num);\n\n      if (stage.current === null) {\n        stage.current = value;\n      }\n\n      var cvalue = (options.scrub ? stage.current : 0) + map(num - (options.scrub ? CENTER : 0), 0, PRECISION, options.scrub ? 0 : min, options.scrub ? distance * 2 : max);\n      setValue(clamp(cvalue, min, max));\n    }\n  }));\n};\n\nfunction _templateObject2$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  opacity: 0;\\n  margin-right: -15px;\\n  & + \", \":after {\\n    position: absolute;\\n    content: \\\"\\\";\\n    display: inline-block;\\n    height: 4px;\\n    width: 8px;\\n    border-left: 2px solid;\\n    border-bottom: 2px solid;\\n    left: 3px;\\n    top: 4px;\\n    opacity: 0;\\n    transform: translate(0px, 2px) rotate(-45deg);\\n    transition: ease-in-out 125ms;\\n    transition-property: opacity, transform;\\n  }\\n  &:checked + \", \":after {\\n    opacity: 1;\\n    transform: translate(0px, 0px) rotate(-45deg);\\n  }\\n  &:checked + \", \" {\\n    background: rgba(0, 0, 0, 0.045);\\n    border-color: rgba(0, 0, 0, 0.085);\\n  }\\n\"]);\n\n  _templateObject2$1 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  height: 16px;\\n  width: 16px;\\n  border: 2px solid rgba(0, 0, 0, 0.065);\\n  border-radius: 4px;\\n  position: relative;\\n  margin-top: -1px;\\n  transition: ease-in-out 125ms;\\n  transition-property: background-color, border-color;\\n\"]);\n\n  _templateObject$2 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar FakeCheckbox = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject$2());\nvar Checkbox = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject2$1(), FakeCheckbox, FakeCheckbox, FakeCheckbox);\n\nfunction BooleanControl(_ref) {\n  var id = _ref.id,\n      name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue;\n  var htmlFor = \"Control\" + id;\n  return React.createElement(BaseControl, {\n    flexLabel: true,\n    label: name,\n    htmlFor: htmlFor\n  }, React.createElement(Checkbox, {\n    id: htmlFor,\n    type: \"checkbox\",\n    checked: value,\n    onChange: function onChange(e) {\n      return setValue(e.currentTarget.checked);\n    }\n  }), React.createElement(FakeCheckbox, {\n    htmlFor: htmlFor\n  }));\n}\n\nfunction _templateObject$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n\\n  display: block;\\n  position: relative;\\n\\n  width: 100%;\\n  height: 32px;\\n\\n  color: #000;\\n\\n  border: 0;\\n  background-color: rgba(0, 0, 0, 0.045);\\n  border-radius: 4px;\\n  padding: 0 4px;\\n\"]);\n\n  _templateObject$3 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Button = /*#__PURE__*/styled.button( /*#__PURE__*/_templateObject$3());\n\nfunction ButtonControl(_ref) {\n  var name = _ref.name,\n      options = _ref.options;\n  return React.createElement(\"div\", {\n    style: {\n      paddingTop: 8,\n      paddingBottom: 8\n    }\n  }, React.createElement(Button, {\n    onClick: function onClick(e) {\n      if (options.onClick) {\n        options.onClick(e);\n      }\n    }\n  }, name));\n}\n\nfunction _templateObject3$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  top: 24px;\\n  right: 0px;\\n  z-index: 100;\\n\"]);\n\n  _templateObject3$1 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 32px;\\n  height: 16px;\\n  border: 2px solid white;\\n  box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.3);\\n  cursor: pointer;\\n\"]);\n\n  _templateObject2$2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n\\n  > div {\\n    box-sizing: border-box !important;\\n  }\\n\"]);\n\n  _templateObject$4 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar ColorPicker = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$4());\nvar ColorBox = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$2());\nvar Picker = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject3$1());\n\nfunction ColorControl(_ref) {\n  var name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  var _options$inline = options.inline,\n      inline = _options$inline === void 0 ? false : _options$inline,\n      _options$picker = options.picker,\n      picker = _options$picker === void 0 ? 'chrome' : _options$picker;\n\n  var _useState = useState(false),\n      open = _useState[0],\n      setOpen = _useState[1];\n\n  var pickerRef = useRef();\n\n  var handleClick = function handleClick(e) {\n    if (pickerRef.current && !pickerRef.current.contains(e.target)) {\n      setOpen(false);\n    }\n  };\n\n  useEffect(function () {\n    document.body.addEventListener('click', handleClick);\n    return function () {\n      document.body.removeEventListener('click', handleClick);\n    };\n  }, []);\n  var pickerProps = {\n    color: value,\n    onChange: function onChange(color) {\n      return setValue(color.rgb);\n    },\n    disableAlpha: options.disableAlpha,\n    colors: options.colors\n  };\n  var PickerElement = ChromePicker;\n\n  switch (picker) {\n    case 'alpha':\n      PickerElement = AlphaPicker;\n      break;\n\n    case 'block':\n      PickerElement = BlockPicker;\n      break;\n\n    case 'circle':\n      PickerElement = CirclePicker;\n      break;\n\n    case 'compact':\n      PickerElement = CompactPicker;\n      break;\n\n    case 'github':\n      PickerElement = GithubPicker;\n      break;\n\n    case 'hue':\n      PickerElement = HuePicker;\n      break;\n\n    case 'material':\n      PickerElement = MaterialPicker;\n      break;\n\n    case 'sketch':\n      PickerElement = SketchPicker;\n      pickerProps.presetColors = options.colors;\n      break;\n\n    case 'slider':\n      PickerElement = SliderPicker;\n      break;\n\n    case 'swatches':\n      PickerElement = SwatchesPicker;\n      break;\n\n    case 'twitter':\n      PickerElement = TwitterPicker;\n      break;\n  }\n\n  return React.createElement(BaseControl, {\n    stack: inline,\n    label: name,\n    flexLabel: true\n  }, React.createElement(ColorPicker, null, inline ? React.createElement(PickerElement, Object.assign({}, pickerProps, {\n    triangle: inline ? 'hide' : undefined,\n    width: 268\n  })) : React.createElement(React.Fragment, null, React.createElement(ColorBox, {\n    style: {\n      backgroundColor: value\n    },\n    onClick: function onClick() {\n      return setOpen(function (lastValue) {\n        return !lastValue;\n      });\n    }\n  }), React.createElement(Picker, {\n    hidden: open !== true,\n    ref: pickerRef\n  }, React.createElement(PickerElement, Object.assign({}, pickerProps))))));\n}\n\nfunction _templateObject$5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n\\n  display: block;\\n  position: relative;\\n\\n  width: 100%;\\n  height: 32px;\\n\\n  color: #000;\\n\\n  margin-left: 8px;\\n\\n  border: 0;\\n  background-color: rgba(0, 0, 0, 0.025);\\n  border-radius: 4px;\\n  padding: 0 4px;\\n\"]);\n\n  _templateObject$5 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Select = /*#__PURE__*/styled.select( /*#__PURE__*/_templateObject$5());\n\nfunction SelectControl(_ref) {\n  var name = _ref.name,\n      setValue = _ref.setValue,\n      value = _ref.value,\n      options = _ref.options;\n  var _options$items = options.items,\n      items = _options$items === void 0 ? [] : _options$items;\n  return React.createElement(BaseControl, {\n    label: name\n  }, React.createElement(Select, {\n    value: value,\n    onChange: function onChange(e) {\n      return setValue(e.currentTarget.value);\n    }\n  }, items.map(function (item, i) {\n    return React.createElement(\"option\", {\n      key: i\n    }, item);\n  })));\n}\n\nfunction _templateObject$6() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n\\n  display: block;\\n  position: relative;\\n\\n  width: 100%;\\n  height: 32px;\\n\\n  color: #000;\\n\\n  margin-left: 8px;\\n\\n  border: 0;\\n  background-color: rgba(0, 0, 0, 0.025);\\n  border-radius: 4px;\\n  padding: 0 4px;\\n\"]);\n\n  _templateObject$6 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Input = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject$6());\nvar StringControl = /*#__PURE__*/React.memo(function (_ref) {\n  var name = _ref.name,\n      setValue = _ref.setValue,\n      value = _ref.value;\n  return React.createElement(BaseControl, {\n    label: name\n  }, React.createElement(Input, {\n    value: value,\n    onChange: function onChange(e) {\n      return setValue(e.target.value);\n    }\n  }));\n});\nvar THRESHOLD = 0.00001;\n\nvar XYPadControl = function XYPadControl(_ref) {\n  var name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  var stage = useRef(null);\n  var _options$distance = options.distance,\n      distance = _options$distance === void 0 ? 1 : _options$distance,\n      _options$scrub = options.scrub,\n      scrub = _options$scrub === void 0 ? false : _options$scrub;\n\n  var _useMeasure = useMeasure(),\n      ref = _useMeasure[0],\n      _useMeasure$ = _useMeasure[1],\n      width = _useMeasure$.width,\n      height = _useMeasure$.height;\n\n  var _useSpring = useSpring(function () {\n    return {\n      from: {\n        x: value.x,\n        y: value.y\n      },\n      onChange: function onChange(value, b) {\n        var clampMx = b.key === 'x' ? width : height;\n        var v = clamp(map(value, 0, clampMx / 2, 0, distance), -distance, distance) || 0;\n\n        if (!scrub) {\n          setValue(function (prev) {\n            var _extends2;\n\n            return _extends({}, prev, (_extends2 = {}, _extends2[b.key] = v < THRESHOLD && v > -THRESHOLD ? 0 : v, _extends2));\n          });\n        }\n      }\n    };\n  }, [width, height]),\n      cursor = _useSpring[0],\n      setCursor = _useSpring[1];\n\n  var bind = useDrag(function (_ref2) {\n    var down = _ref2.down,\n        movement = _ref2.movement;\n\n    if (down && !stage.current) {\n      stage.current = value;\n    } else if (!down) {\n      stage.current = null;\n    }\n\n    setCursor({\n      x: down ? movement[0] : 0,\n      y: down ? movement[1] : 0\n    });\n\n    if (scrub) {\n      if (down) {\n        setValue(function () {\n          return {\n            x: stage.current.x + map(movement[0], 0, width / 2, 0, distance),\n            y: stage.current.y + map(movement[1], 0, height / 2, 0, distance)\n          };\n        });\n      } else {\n        stage.current = value;\n      }\n    }\n  });\n  var x = cursor.x.to(function (n) {\n    return clamp(n + width / 2, 0, width);\n  });\n  var y = cursor.y.to(function (n) {\n    return clamp(n + height / 2, 0, height);\n  });\n  return React.createElement(BaseControl, {\n    stack: true,\n    label: name,\n    value: \"x: \" + value.x.toFixed(1) + \", y: \" + value.y.toFixed(1)\n  }, React.createElement(animated.svg, Object.assign({\n    ref: ref,\n    style: {\n      userSelect: 'none',\n      borderRadius: 8,\n      border: '1px solid #f0f0f0'\n    },\n    width: \"100%\",\n    height: 200,\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, bind()), React.createElement(\"rect\", {\n    fill: \"rgb(250, 250, 250)\",\n    width: \"100%\",\n    height: \"100%\"\n  }), React.createElement(animated.line, {\n    x1: x,\n    x2: x,\n    y1: 0,\n    y2: \"100%\",\n    stroke: \"#ccc\"\n  }), React.createElement(animated.line, {\n    x1: 0,\n    x2: \"100%\",\n    y1: y,\n    y2: y,\n    stroke: \"#ccc\"\n  }), React.createElement(animated.g, {\n    style: {\n      transform: to([x, y], function (x, y) {\n        return \"translate(\" + x + \"px, \" + y + \"px)\";\n      })\n    }\n  }, React.createElement(\"circle\", {\n    r: 8,\n    fill: \"#ccc\"\n  }), React.createElement(\"circle\", {\n    r: 4,\n    fill: \"#aaa\"\n  }))));\n};\n\nfunction _templateObject$7() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 100%;\\n\"]);\n\n  _templateObject$7 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar FileInput = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject$7());\n\nvar FileControl = function FileControl(_ref) {\n  var name = _ref.name,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  return React.createElement(BaseControl, {\n    label: name\n  }, React.createElement(FileInput, {\n    type: \"file\",\n    onChange: function onChange(e) {\n      var _options$loader;\n\n      var loader = (_options$loader = options.loader) !== null && _options$loader !== void 0 ? _options$loader : new FileLoader();\n\n      if (loader.setCrossOrigin) {\n        loader.setCrossOrigin('');\n      }\n\n      var file = e.currentTarget.files && e.currentTarget.files[0];\n      var texture = loader.load(URL.createObjectURL(file));\n      setValue(texture);\n    }\n  }));\n};\n\nvar _ControlComponents;\n\nvar ControlComponents = (_ControlComponents = {}, _ControlComponents[ControlType.NUMBER] = NumberControl, _ControlComponents[ControlType.BOOLEAN] = BooleanControl, _ControlComponents[ControlType.SELECT] = SelectControl, _ControlComponents[ControlType.COLOR] = ColorControl, _ControlComponents[ControlType.STRING] = StringControl, _ControlComponents[ControlType.BUTTON] = ButtonControl, _ControlComponents[ControlType.FILE] = FileControl, _ControlComponents[ControlType.XYPAD] = XYPadControl, _ControlComponents);\n\nvar Noop = function Noop(_ref) {\n  var name = _ref.name,\n      options = _ref.options;\n  return React.createElement(BaseControl, {\n    label: name\n  }, \"\\\"\", options.type, \"\\\" not found\");\n};\n\nvar ControlItem = function ControlItem(_ref2) {\n  var _ref3, _options$component, _options$type;\n\n  var name = _ref2.name,\n      id = _ref2.id,\n      defaultValue = _ref2.value,\n      options = _ref2.options;\n  var context = useContext(ControlsContext);\n\n  var _useState = useState(context.values.current && context.values.current.has(id) ? context.values.current.get(id) : defaultValue),\n      value = _useState[0],\n      setValue = _useState[1];\n\n  useEffect(function () {\n    context.values.current.set(id, value);\n  }, [context.values, id, value]);\n  useEffect(function () {\n    context.gui.current.set(id, setValue);\n  }, [context.gui, id]);\n  var Component = (_ref3 = (_options$component = options.component) !== null && _options$component !== void 0 ? _options$component : ControlComponents[(_options$type = options.type) !== null && _options$type !== void 0 ? _options$type : ControlType.NUMBER]) !== null && _ref3 !== void 0 ? _ref3 : Noop;\n  return React.createElement(Component, {\n    id: id,\n    name: name,\n    value: value,\n    setValue: function setValue(newValue) {\n      var _context$gui$current, _context$gui$current$, _context$state$curren, _context$state$curren2;\n\n      (_context$gui$current = context.gui.current) === null || _context$gui$current === void 0 ? void 0 : (_context$gui$current$ = _context$gui$current.get(id)) === null || _context$gui$current$ === void 0 ? void 0 : _context$gui$current$(newValue);\n      (_context$state$curren = context.state.current) === null || _context$state$curren === void 0 ? void 0 : (_context$state$curren2 = _context$state$curren.get(id)) === null || _context$state$curren2 === void 0 ? void 0 : _context$state$curren2(newValue);\n    },\n    options: options\n  });\n};\n\nfunction _templateObject2$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background: \", \";\\n  padding: 16px;\\n  display: \", \";\\n  margin-bottom: 8px;\\n\"]);\n\n  _templateObject2$3 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$8() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n  font-family: sans-serif;\\n  font-size: 13px;\\n  font-weight: bold;\\n  padding-left: 16px;\\n  cursor: pointer;\\n  position: relative;\\n  user-select: none;\\n\\n  &:before,\\n  &:after {\\n    content: '';\\n    position: absolute;\\n    top: 8px;\\n    right: 16px;\\n    width: 12px;\\n    height: 2px;\\n    background-color: #333;\\n    /* transition: transform 0.25s ease-out; */\\n  }\\n  &:before {\\n    transform: rotate(\", \"deg);\\n  }\\n\\n  &:after {\\n    transform: rotate(\", \"deg);\\n  }\\n\"]);\n\n  _templateObject$8 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Heading = /*#__PURE__*/styled.h2( /*#__PURE__*/_templateObject$8(), function (props) {\n  return props.open ? 0 : 90;\n}, function (props) {\n  return props.open ? 0 : 180;\n});\nvar Container = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$3(), function (props) {\n  return props.bg ? '#f9f9f9' : '#fff';\n}, function (props) {\n  return props.open ? 'block' : 'none';\n});\n\nvar ControlGroup = function ControlGroup(_ref) {\n  var _options$defaultClose;\n\n  var title = _ref.title,\n      controls = _ref.controls,\n      _ref$options = _ref.options,\n      options = _ref$options === void 0 ? {} : _ref$options;\n\n  var _useState = useState((_options$defaultClose = !options.defaultClosed) !== null && _options$defaultClose !== void 0 ? _options$defaultClose : true),\n      open = _useState[0],\n      setOpen = _useState[1];\n\n  var isDefault = title !== 'DEFAULT_GROUP';\n  return React.createElement(\"div\", null, isDefault && React.createElement(Heading, {\n    open: open,\n    onClick: function onClick() {\n      return setOpen(function (o) {\n        return !o;\n      });\n    }\n  }, title), React.createElement(Container, {\n    open: open,\n    bg: isDefault\n  }, Array.from(controls).map(function (control) {\n    return React.createElement(ControlItem, Object.assign({\n      key: control.id + \"_\" + control.name\n    }, control));\n  })));\n};\n\nfunction _templateObject4$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  padding-bottom: 8px;\\n  overflow-y: auto;\\n  max-height: calc(100vh - 42px);\\n\"]);\n\n  _templateObject4$1 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 30px;\\n  height: 18px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  margin-left: auto;\\n  cursor: pointer;\\n  &:after {\\n    content: '';\\n    display: block;\\n    height: 3px;\\n    width: 16px;\\n    background-color: white;\\n  }\\n  \", \" {\\n    &:before {\\n      content: '';\\n      display: block;\\n      position: absolute;\\n      top: 0;\\n      right: 0;\\n      bottom: 0;\\n      left: 0;\\n    }\\n  }\\n\"]);\n\n  _templateObject3$2 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  align-items: center;\\n  position: relative;\\n  padding-left: 16px;\\n  padding-right: 16px;\\n  height: 42px;\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: #fff;\\n  cursor: move;\\n  cursor: grab;\\n  user-select: none;\\n  background-color: #000;\\n  border-top-left-radius: 8px;\\n  border-top-right-radius: 8px;\\n  border-bottom-left-radius: \", \"px;\\n  border-bottom-right-radius: \", \"px;\\n  box-shadow: 0 0 14px 0 rgba(0, 0, 0, 0.14);\\n  \", \" {\\n    border-top-left-radius: 0px;\\n    border-top-right-radius: 0px;\\n    border-bottom-left-radius: 0px;\\n    border-bottom-right-radius: 0px;\\n  }\\n\"]);\n\n  _templateObject2$4 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$9() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: column;\\n  position: fixed;\\n  top: \", \";\\n  right: \", \";\\n  bottom: \", \";\\n  left: \", \";\\n  width: \", \"px;\\n  border-radius: 16px;\\n  background-color: #fff;\\n  border-radius: 8px;\\n  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);\\n\\n  \", \" {\\n    transform: none !important;\\n    flex-direction: column-reverse;\\n    top: auto;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    width: auto;\\n  }\\n\"]);\n\n  _templateObject$9 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar mq = \"@media only screen and (max-width: 600px)\";\nvar ControlsAnchor;\n\n(function (ControlsAnchor) {\n  ControlsAnchor[\"TOP_LEFT\"] = \"top_left\";\n  ControlsAnchor[\"TOP_RIGHT\"] = \"top_right\";\n  ControlsAnchor[\"BOTTOM_LEFT\"] = \"bottom_left\";\n  ControlsAnchor[\"BOTTOM_RIGHT\"] = \"bottom_right\";\n})(ControlsAnchor || (ControlsAnchor = {}));\n\nfunction posProps(positions) {\n  return function posPropsFn(props) {\n    return positions.includes(props['data-anchor']) ? '16px' : 'auto';\n  };\n}\n\nvar Float = /*#__PURE__*/styled(animated.div)( /*#__PURE__*/_templateObject$9(), /*#__PURE__*/posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.TOP_RIGHT]), /*#__PURE__*/posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.TOP_RIGHT]), /*#__PURE__*/posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.BOTTOM_LEFT]), /*#__PURE__*/posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT]), function (props) {\n  return props['data-width'];\n}, mq);\nvar Header = /*#__PURE__*/styled(animated.div)( /*#__PURE__*/_templateObject2$4(), function (props) {\n  return props['data-collapsed'] ? 0 : 8;\n}, function (props) {\n  return props['data-collapsed'] ? 0 : 8;\n}, mq);\nvar CollapseIcon = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject3$2(), mq);\nvar Items = /*#__PURE__*/styled(animated.div)( /*#__PURE__*/_templateObject4$1());\n\nvar groupByGroup = function groupByGroup(items) {\n  return Array.from(items).reduce(function (acc, item) {\n    var _item$options;\n\n    var groupName = (item === null || item === void 0 ? void 0 : (_item$options = item.options) === null || _item$options === void 0 ? void 0 : _item$options.group) || DEFAULT_GROUP;\n    acc[groupName] = acc[groupName] || [];\n    acc[groupName].push(item);\n    return acc;\n  }, {});\n};\n\nvar Controls = function Controls(props) {\n  var _props$title = props.title,\n      title = _props$title === void 0 ? 'react-three-gui' : _props$title,\n      _props$defaultClosedG = props.defaultClosedGroups,\n      defaultClosedGroups = _props$defaultClosedG === void 0 ? [] : _props$defaultClosedG,\n      _props$width = props.width,\n      width = _props$width === void 0 ? 300 : _props$width,\n      _props$style = props.style,\n      style = _props$style === void 0 ? {} : _props$style,\n      _props$anchor = props.anchor,\n      anchor = _props$anchor === void 0 ? ControlsAnchor.TOP_RIGHT : _props$anchor;\n\n  var _useContext = useContext(ControlsContext),\n      controls = _useContext.controls;\n\n  var _useLocalStorage = useLocalStorage('REACT_THREE_GUI__COLLAPSED', props.collapsed),\n      collapsed = _useLocalStorage[0],\n      setCollapsed = _useLocalStorage[1];\n\n  var _useLocalStorage2 = useLocalStorage(\"REACT_THREE_GUI__\" + anchor, [0, 0]),\n      position = _useLocalStorage2[0],\n      setPosition = _useLocalStorage2[1];\n\n  var _useMeasure = useMeasure(),\n      ref = _useMeasure[0],\n      bounds = _useMeasure[1];\n\n  var _useSpring = useSpring(function () {\n    return {\n      pos: position,\n      onRest: function onRest(_ref) {\n        var value = _ref.value;\n        setPosition(value);\n      }\n    };\n  }),\n      pos = _useSpring[0].pos,\n      setPos = _useSpring[1];\n\n  var left = [ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT].includes(anchor);\n  var top = [ControlsAnchor.TOP_RIGHT, ControlsAnchor.TOP_LEFT].includes(anchor);\n  var bind = useDrag(function (_ref2) {\n    var movement = _ref2.movement,\n        _ref2$memo = _ref2.memo,\n        memo = _ref2$memo === void 0 ? pos ? pos.getValue ? pos.getValue() : pos.get() : 0 : _ref2$memo;\n    var x = movement[0] + memo[0],\n        y = movement[1] + memo[1];\n    setPos({\n      pos: [left ? clamp(x, 1, window.innerWidth - width - 32) : clamp(x, -window.innerWidth + width + 32, 1), top ? clamp(y, 1, window.innerHeight) : clamp(y, -window.innerHeight + bounds.height + 32, 1)]\n    });\n    return memo;\n  });\n\n  var getGroupOptions = function getGroupOptions(groupName) {\n    var _defaultClosedGroups$;\n\n    return {\n      defaultClosed: (_defaultClosedGroups$ = defaultClosedGroups === null || defaultClosedGroups === void 0 ? void 0 : defaultClosedGroups.includes(groupName)) !== null && _defaultClosedGroups$ !== void 0 ? _defaultClosedGroups$ : false\n    };\n  };\n\n  var groups = groupByGroup(controls);\n  return React.createElement(Float, {\n    \"data-width\": width,\n    \"data-anchor\": anchor,\n    ref: ref,\n    style: _extends({}, style, {\n      transform: to([pos], function (_ref3) {\n        var x = _ref3[0],\n            y = _ref3[1];\n        return \"translate3d(\" + x + \"px,\" + y + \"px,0)\";\n      })\n    })\n  }, React.createElement(Header, Object.assign({\n    \"data-collapsed\": collapsed\n  }, bind()), title, React.createElement(CollapseIcon, {\n    collapsed: collapsed,\n    onClick: function onClick() {\n      return setCollapsed(function (c) {\n        return !c;\n      });\n    }\n  })), React.createElement(Items, {\n    hidden: !collapsed,\n    style: {\n      maxHeight: top ? to([pos], function (_ref4) {\n        var y = _ref4[1];\n        return \"calc(100vh - \" + (y + 92) + \"px)\";\n      }) : undefined\n    }\n  }, Object.entries(groups).map(function (_ref5) {\n    var groupName = _ref5[0],\n        items = _ref5[1];\n    return React.createElement(ControlGroup, {\n      key: groupName,\n      title: groupName,\n      controls: items,\n      options: getGroupOptions(groupName)\n    });\n  })));\n};\n\nControls.Provider = ControlsProvider;\nControls.Canvas = Canvas;\n\nvar useControl = function useControl(name, options) {\n  if (options === void 0) {\n    options = defaultOptions;\n  }\n\n  var context = useContext(ControlsContext);\n\n  var _useState = useState(null),\n      id = _useState[0],\n      setId = _useState[1];\n\n  var _useState2 = useState(defaultValue(options)),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var _useSpring = useSpring$1(function () {\n    return {\n      value: value,\n      config: typeof options.spring === 'object' ? options.spring : undefined\n    };\n  }),\n      spring = _useSpring[0],\n      setSpring = _useSpring[1];\n\n  var setSpringValue = function setSpringValue(springValue) {\n    return setSpring({\n      value: springValue\n    });\n  };\n\n  if (options.state) {\n    value = options.state[0];\n    setValue = options.state[1];\n  }\n\n  useEffect(function () {\n    if (context.state.current && id) {\n      if (options.spring) {\n        context.state.current.set(id, setSpringValue);\n      } else {\n        context.state.current.set(id, setValue);\n      }\n    }\n  }, [context.state, id]);\n  useEffect(function () {\n    var ctrl = context.addControl({\n      id: options.id,\n      name: name,\n      value: value,\n      options: options\n    });\n    setId(ctrl.id);\n    return function () {\n      context.removeControl(ctrl);\n    };\n  }, []);\n  useEffect(function () {\n    options.spring && void setSpring({\n      value: value\n    });\n    options.onChange && void options.onChange(value);\n  }, [options, setSpring, value]);\n\n  if (options.spring) {\n    return spring.value;\n  }\n\n  return value;\n};\n\nexport { BaseControl, ControlType, Controls, ControlsContext, DEFAULT_GROUP, useControl, withControls };","map":{"version":3,"sources":["../src/contexts/controls-context.ts","../src/components/controls-provider.tsx","../src/types.ts","../src/utils.ts","../src/hooks/use-local-storage.ts","../src/components/controls/base-control.tsx","../src/components/controls/number-control.tsx","../src/components/controls/boolean-control.tsx","../src/components/controls/button-control.tsx","../src/components/controls/color-control.tsx","../src/components/controls/select-control.tsx","../src/components/controls/string-control.tsx","../src/components/controls/xy-pad-control.tsx","../src/components/controls/file-control.tsx","../src/components/control-item.tsx","../src/components/control-group.tsx","../src/components/controls.tsx","../src/hooks/use-control.ts"],"names":["ControlsContext","createContext","values","current","gui","state","controls","addControl","removeControl","ControlsProvider","children","setControls","useState","useRef","context","control","String","Math","c","ctrl","value","withControls","CanvasEl","props","React","Canvas","DEFAULT_GROUP","ControlType","defaultOptions","type","defaultValue","options","x","y","clamp","higher","map","y2","y1","useLocalStorage","key","initialValue","storedValue","setStoredValue","item","window","JSON","console","setValue","valueToStore","Row","styled","Label","Content","Value","BaseControl","htmlFor","label","flexLabel","stack","InputRange","PRECISION","CENTER","NumberControl","name","ref","stage","min","max","PI","distance","val","setVal","handleChange","useCallback","useEffect","el","onChange","num","Number","e","cvalue","FakeCheckbox","Checkbox","BooleanControl","id","checked","Button","ButtonControl","style","paddingTop","paddingBottom","onClick","ColorPicker","ColorBox","Picker","ColorControl","inline","picker","open","setOpen","pickerRef","handleClick","document","pickerProps","color","disableAlpha","colors","PickerElement","triangle","undefined","width","backgroundColor","hidden","Select","SelectControl","items","i","Input","StringControl","THRESHOLD","XYPadControl","scrub","height","useMeasure","cursor","setCursor","useSpring","from","clampMx","b","v","bind","useDrag","down","movement","n","animated","userSelect","borderRadius","border","xmlns","fill","x1","x2","stroke","transform","to","r","FileInput","FileControl","loader","file","texture","URL","ControlComponents","Noop","ControlItem","useContext","Component","Heading","Container","ControlGroup","title","isDefault","bg","mq","ControlsAnchor","positions","Float","posProps","Header","CollapseIcon","Items","groupByGroup","groupName","acc","Controls","defaultClosedGroups","anchor","TOP_RIGHT","collapsed","setCollapsed","position","setPosition","bounds","pos","setPos","onRest","left","top","memo","getGroupOptions","defaultClosed","groups","maxHeight","useControl","setId","spring","setSpring","config","setSpringValue","springValue"],"mappings":"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","sourcesContent":["import { createContext, RefObject, SetStateAction } from 'react';\nimport { ControlItem } from 'types';\n\ninterface IControlsContext {\n  values: RefObject<Map<string, any>>;\n  gui: RefObject<Map<string, SetStateAction<any>>>;\n  state: RefObject<Map<string, SetStateAction<any>>>;\n  controls: ControlItem[];\n  addControl(control: ControlItem): ControlItem;\n  removeControl(control: ControlItem): any;\n}\n\nexport const ControlsContext = createContext<IControlsContext>({\n  values: { current: new Map() },\n  gui: { current: new Map() },\n  state: { current: new Map() },\n  controls: [],\n  addControl(control: ControlItem) {\n    return control;\n  },\n  removeControl() {},\n});\n","import React, { useState, useRef } from 'react';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { Canvas as R3FCanvas } from 'react-three-fiber';\nimport { ControlItem } from 'types';\n\nexport const ControlsProvider = ({\n  children,\n}: {\n  children: React.ReactNode;\n}) => {\n  const [controls, setControls] = useState<ControlItem[]>([]);\n  // Persist values between reloads\n  const values = useRef(new Map());\n  // GUI control state setters\n  const gui = useRef(new Map());\n  // useControl state setters\n  const state = useRef(new Map());\n\n  const context = {\n    values,\n    gui,\n    state,\n    controls,\n    addControl: (control: ControlItem) => {\n      control.id = String(Math.random());\n      setControls(ctrls => {\n        // control.id = control.id ?? String(ctrls.length);\n        return [...ctrls, control];\n      });\n      return control;\n    },\n    removeControl: (ctrl: ControlItem) => {\n      setControls(ctrls => ctrls.filter(c => c.id !== ctrl.id));\n    },\n  };\n\n  return (\n    <ControlsContext.Provider value={context}>\n      {children}\n    </ControlsContext.Provider>\n  );\n};\n\nexport function withControls(CanvasEl: typeof R3FCanvas) {\n  return ({ children, ...props }: any) => (\n    <ControlsContext.Consumer>\n      {value => (\n        <CanvasEl {...props}>\n          <ControlsContext.Provider value={value}>\n            {children}\n          </ControlsContext.Provider>\n        </CanvasEl>\n      )}\n    </ControlsContext.Consumer>\n  );\n}\n\nexport const Canvas = withControls(R3FCanvas);\n","import { Dispatch, SetStateAction, MouseEvent } from 'react';\nimport { SpringConfig } from '@react-spring/three';\n\nexport const DEFAULT_GROUP = 'DEFAULT_GROUP';\n\nexport type ControlItem = {\n  id: string;\n  name: string;\n  value: any;\n  options: ControlOptions;\n};\n\nexport enum ControlType {\n  NUMBER = 'number',\n  STRING = 'string',\n  BUTTON = 'button',\n  BOOLEAN = 'boolean',\n  SELECT = 'select',\n  COLOR = 'color',\n  XYPAD = 'xypad',\n  FILE = 'file',\n  CUSTOM = 'custom',\n}\n\nexport type ControlComponentProps<T> = ControlItem & {\n  setValue(value: any): void;\n  options: T;\n};\n\nexport type ControlOptionsBase = {\n  /** Unique id for control */\n  id?: string;\n  /* The control type */\n  type: ControlType | string;\n  /** Default value */\n  value?: any;\n  /* Return useSpring instead of useState */\n  spring?: boolean | SpringConfig;\n  /* Group this control */\n  group?: string;\n  /* Use your own state */\n  state?: [any, Dispatch<SetStateAction<any>>];\n  /* onChange callback */\n  onChange?(value: any): void;\n};\n\nexport type ControlOptionsNumber = {\n  type: ControlType.NUMBER | 'number';\n  /* Minimum value */\n  min?: number;\n  /* Maximum value */\n  max?: number;\n  /* Initial value */\n  value?: number;\n  /* Slider distance */\n  distance?: number;\n  /* Scrub value in both directions */\n  scrub?: boolean;\n};\n\nexport type ControlOptionsString = {\n  type: ControlType.STRING | 'string';\n  /* Initial value */\n  value?: string;\n};\n\nexport type ControlOptionsFile = {\n  type: ControlType.FILE | 'file';\n  /* Initial value */\n  value?: string;\n  /** Loader */\n  loader?: {\n    load(url: string): any;\n  };\n};\n\nexport type ControlOptionsButton = {\n  type: ControlType.BUTTON | 'button';\n  /* Fired on button click */\n  onClick?(e: MouseEvent<HTMLButtonElement>): any;\n};\n\nexport type ControlOptionsBoolean = {\n  type: ControlType.BOOLEAN | 'boolean';\n  value?: boolean;\n};\n\nexport type ControlOptionsSelect = {\n  type: ControlType.SELECT | 'select';\n  /* List of items to select from */\n  items: string[];\n  /* Initial value */\n  value?: string;\n};\n\nexport type ControlOptionsColor = {\n  type: ControlType.COLOR | 'color';\n  /* Initial value as HEX code */\n  value?: string;\n  /* Show picker as inline */\n  inline?: boolean;\n  /* What kind of picker. Default Chrome */\n  picker?:\n    | 'chrome'\n    | 'sketch'\n    | 'hue'\n    | 'alpha'\n    | 'block'\n    | 'github'\n    | 'twitter'\n    | 'circle'\n    | 'material'\n    | 'compact'\n    | 'slider'\n    | 'swatches';\n  /* Disable alpha */\n  disableAlpha?: boolean;\n  /* Custom set of colors */\n  colors?: string[];\n};\n\nexport type ControlOptionsXYPad = {\n  type: ControlType.XYPAD | 'xypad';\n  /* Initial value as { x, y } object */\n  value?: { x: number; y: number };\n  /* Pad drag distance */\n  distance?: number;\n  /* Scrub value in both directions */\n  scrub?: boolean;\n};\n\nexport type ControlOptionsCustom = {\n  type: ControlType.CUSTOM | 'custom';\n  /* Custom React component */\n  component?: any;\n};\n\nexport type ControlOptions = ControlOptionsBase &\n  (\n    | ControlOptionsCustom\n    | ControlOptionsNumber\n    | ControlOptionsBoolean\n    | ControlOptionsString\n    | ControlOptionsButton\n    | ControlOptionsColor\n    | ControlOptionsSelect\n    | ControlOptionsFile\n    | ControlOptionsXYPad\n  );\n","import { ControlOptions, ControlType } from './types';\nimport * as THREE from 'three';\n\nexport const defaultOptions: ControlOptions = {\n  type: ControlType.NUMBER,\n  value: 0,\n};\n\nexport const defaultValue = (options: ControlOptions) => {\n  if (options.hasOwnProperty('value')) {\n    return options.value;\n  }\n\n  switch (options.type) {\n    case ControlType.NUMBER:\n      return 0;\n    case ControlType.COLOR:\n      return '#ff0000';\n    case ControlType.STRING:\n      return '';\n    case ControlType.SELECT:\n      return (options.items || [''])[0];\n    case ControlType.BOOLEAN:\n      return false;\n    case ControlType.FILE:\n      return new THREE.FileLoader();\n    case ControlType.XYPAD:\n      return { x: 0, y: 0 };\n  }\n\n  return undefined;\n};\n\nexport const clamp = (num: number, clamp: number, higher?: number) =>\n  higher !== undefined\n    ? Math.min(Math.max(num, clamp), higher)\n    : Math.min(num, clamp);\n\nexport const map = (\n  value: number,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => ((value - x1) * (y2 - x2)) / (y1 - x1) + x2;\n","import { useState } from 'react';\n\nexport function useLocalStorage(key: string, initialValue: any) {\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.log(error);\n      return initialValue;\n    }\n  });\n\n  const setValue = (value: any) => {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n","import React from 'react';\nimport styled from 'styled-components';\n\ntype SCProps = {\n  stack?: boolean;\n  flexLabel?: boolean;\n};\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 8px 0;\n`;\n\nconst Label = styled.label<SCProps>`\n  display: flex;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n  width: 56px;\n  user-select: none;\n  ${props => (props.flexLabel === true ? 'flex: 1;' : '')}\n`;\n\nconst Content = styled.div<SCProps>`\n  display: flex;\n  ${props => (props.flexLabel !== true ? 'flex: 1;' : '')}\n  justify-content: flex-end;\n  padding: 0 8px;\n`;\n\nconst Value = styled.div<SCProps>`\n  display: flex;\n  font-family: sans-serif;\n  white-space: nowrap;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.75);\n  justify-content: flex-end;\n  ${props => (props.stack ? 'flex: 1;' : '')}\n  ${props => (props.stack ? '' : 'width: 42px;')}\n`;\n\ntype BaseControlProps = {\n  label?: string;\n  flexLabel?: boolean;\n  value?: string;\n  children?: any;\n  stack?: boolean;\n  htmlFor?: any;\n};\n\nexport function BaseControl({\n  htmlFor,\n  label,\n  flexLabel,\n  value,\n  stack,\n  children,\n}: BaseControlProps) {\n  if (stack) {\n    return (\n      <div>\n        <Row>\n          <Label flexLabel={flexLabel}>{label}</Label>\n          <Value stack flexLabel={flexLabel}>\n            {value}\n          </Value>\n        </Row>\n        {children}\n      </div>\n    );\n  }\n\n  return (\n    <Row>\n      <Label flexLabel={flexLabel} htmlFor={htmlFor}>\n        {label}\n      </Label>\n      <Content flexLabel={flexLabel}>{children}</Content>\n      {typeof value !== 'undefined' && <Value>{value}</Value>}\n    </Row>\n  );\n}\n","import styled from 'styled-components';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { clamp, map } from '../../utils';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsNumber } from '../../types';\n\nconst InputRange = styled.input`\n  -webkit-appearance: none;\n  width: 100%;\n  background: transparent;\n  display: inline-block;\n\n  &:focus {\n    outline: none;\n  }\n\n  &::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 12px;\n    cursor: pointer;\n    background: rgba(0, 0, 0, 0.045);\n    border-radius: 10px;\n  }\n\n  &::-webkit-slider-thumb {\n    border: none;\n    height: 20px;\n    width: 20px;\n    border-radius: 50%;\n    background: #ffffff;\n    cursor: pointer;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.22);\n    -webkit-appearance: none;\n    margin-top: -4px;\n  }\n\n  &:focus::-webkit-slider-runnable-track {\n    outline: none;\n  }\n`;\n\nconst PRECISION = 300;\nconst CENTER = PRECISION / 2;\n\nexport const NumberControl = ({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsNumber>) => {\n  const ref = useRef<HTMLInputElement | null>(null);\n  const stage = useRef(null);\n  const {\n    min = options.scrub ? -Infinity : 0,\n    max = options.scrub ? Infinity : Math.PI,\n  } = options;\n\n  const distance = options.distance ?? options.scrub ? 2 : max - min;\n\n  const [val, setVal] = useState(\n    options.scrub ? CENTER : map(value, min, max, 0, PRECISION)\n  );\n\n  const handleChange = useCallback(() => {\n    if (options.scrub) {\n      setVal(CENTER);\n      stage.current = null;\n    }\n  }, [options.scrub]);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (el) {\n      el.addEventListener('change', handleChange);\n    }\n    return () => {\n      if (el) {\n        el.removeEventListener('change', handleChange);\n      }\n    };\n  }, [handleChange, ref]);\n\n  return (\n    <BaseControl label={name} value={(value || 0).toFixed(2)}>\n      <InputRange\n        ref={ref}\n        type=\"range\"\n        value={val}\n        min={0}\n        max={PRECISION}\n        onChange={e => {\n          const num = Number(e.target.value);\n          setVal(num);\n          if (stage.current === null) {\n            stage.current = value;\n          }\n          const cvalue =\n            (options.scrub ? (stage as any).current : 0) +\n            map(\n              num - (options.scrub ? CENTER : 0),\n              0,\n              PRECISION,\n              options.scrub ? 0 : min,\n              options.scrub ? distance * 2 : max\n            );\n          setValue(clamp(cvalue, min, max));\n        }}\n      />\n    </BaseControl>\n  );\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { BaseControl } from \"./base-control\";\nimport { ControlComponentProps, ControlOptionsBoolean } from \"../../types\";\n\nconst FakeCheckbox = styled.label`\n  height: 16px;\n  width: 16px;\n  border: 2px solid rgba(0, 0, 0, 0.065);\n  border-radius: 4px;\n  position: relative;\n  margin-top: -1px;\n  transition: ease-in-out 125ms;\n  transition-property: background-color, border-color;\n`;\n\nconst Checkbox = styled.input`\n  opacity: 0;\n  margin-right: -15px;\n  & + ${FakeCheckbox}:after {\n    position: absolute;\n    content: \"\";\n    display: inline-block;\n    height: 4px;\n    width: 8px;\n    border-left: 2px solid;\n    border-bottom: 2px solid;\n    left: 3px;\n    top: 4px;\n    opacity: 0;\n    transform: translate(0px, 2px) rotate(-45deg);\n    transition: ease-in-out 125ms;\n    transition-property: opacity, transform;\n  }\n  &:checked + ${FakeCheckbox}:after {\n    opacity: 1;\n    transform: translate(0px, 0px) rotate(-45deg);\n  }\n  &:checked + ${FakeCheckbox} {\n    background: rgba(0, 0, 0, 0.045);\n    border-color: rgba(0, 0, 0, 0.085);\n  }\n`;\n\nexport function BooleanControl({\n  id,\n  name,\n  value,\n  setValue\n}: ControlComponentProps<ControlOptionsBoolean>) {\n  const htmlFor = `Control${id}`;\n  return (\n    <BaseControl flexLabel label={name} htmlFor={htmlFor}>\n      <Checkbox\n        id={htmlFor}\n        type=\"checkbox\"\n        checked={value}\n        onChange={(e) => setValue(e.currentTarget.checked)}\n      />\n      <FakeCheckbox htmlFor={htmlFor} />\n    </BaseControl>\n  );\n}\n","import React, { MouseEvent } from 'react';\nimport styled from 'styled-components';\nimport { ControlComponentProps, ControlOptionsButton } from '../../types';\n\nconst Button = styled.button`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.045);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport function ButtonControl({\n  name,\n  options,\n}: ControlComponentProps<ControlOptionsButton>) {\n  return (\n    <div style={{ paddingTop: 8, paddingBottom: 8 }}>\n      <Button\n        onClick={(e: MouseEvent<HTMLButtonElement>) => {\n          if (options.onClick) {\n            options.onClick(e);\n          }\n        }}\n      >\n        {name}\n      </Button>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport {\n  AlphaPicker,\n  BlockPicker,\n  ChromePicker,\n  CirclePicker,\n  CompactPicker,\n  GithubPicker,\n  HuePicker,\n  MaterialPicker,\n  SketchPicker,\n  SliderPicker,\n  SwatchesPicker,\n  TwitterPicker,\n} from 'react-color';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsColor } from '../../types';\n\nconst ColorPicker = styled.div`\n  position: relative;\n\n  > div {\n    box-sizing: border-box !important;\n  }\n`;\n\nconst ColorBox = styled.div`\n  width: 32px;\n  height: 16px;\n  border: 2px solid white;\n  box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.3);\n  cursor: pointer;\n`;\n\nconst Picker = styled.div<{ hidden: boolean }>`\n  position: absolute;\n  top: 24px;\n  right: 0px;\n  z-index: 100;\n`;\n\nexport function ColorControl({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsColor>) {\n  const { inline = false, picker = 'chrome' } = options;\n  const [open, setOpen] = useState(false);\n  const pickerRef = useRef<HTMLDivElement>();\n  const handleClick = (e: any) => {\n    if (pickerRef.current && !pickerRef.current.contains(e.target)) {\n      setOpen(false);\n    }\n  };\n\n  useEffect(() => {\n    document.body.addEventListener('click', handleClick);\n    return () => {\n      document.body.removeEventListener('click', handleClick);\n    };\n  }, []);\n\n  const pickerProps: any = {\n    color: value,\n    onChange: (color: any) => setValue(color.rgb),\n    disableAlpha: options.disableAlpha,\n    colors: options.colors,\n  };\n\n  let PickerElement: any = ChromePicker;\n\n  switch (picker) {\n    case 'alpha':\n      PickerElement = AlphaPicker;\n      break;\n    case 'block':\n      PickerElement = BlockPicker;\n      break;\n    case 'circle':\n      PickerElement = CirclePicker;\n      break;\n    case 'compact':\n      PickerElement = CompactPicker;\n      break;\n    case 'github':\n      PickerElement = GithubPicker;\n      break;\n    case 'hue':\n      PickerElement = HuePicker;\n      break;\n    case 'material':\n      PickerElement = MaterialPicker;\n      break;\n    case 'sketch':\n      PickerElement = SketchPicker;\n      pickerProps.presetColors = options.colors;\n      break;\n    case 'slider':\n      PickerElement = SliderPicker;\n      break;\n    case 'swatches':\n      PickerElement = SwatchesPicker;\n      break;\n    case 'twitter':\n      PickerElement = TwitterPicker;\n      break;\n  }\n\n  return (\n    <BaseControl stack={inline} label={name} flexLabel>\n      <ColorPicker>\n        {inline ? (\n          <PickerElement\n            {...pickerProps}\n            triangle={inline ? 'hide' : undefined}\n            width={268}\n          />\n        ) : (\n          <>\n            <ColorBox\n              style={{ backgroundColor: value }}\n              onClick={() => setOpen(lastValue => !lastValue)}\n            />\n            <Picker hidden={open !== true} ref={pickerRef as any}>\n              <PickerElement {...pickerProps} />\n            </Picker>\n          </>\n        )}\n      </ColorPicker>\n    </BaseControl>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsSelect } from '../../types';\n\nconst Select = styled.select`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport function SelectControl({\n  name,\n  setValue,\n  value,\n  options,\n}: ControlComponentProps<ControlOptionsSelect>) {\n  const { items = [] } = options;\n  return (\n    <BaseControl label={name}>\n      <Select value={value} onChange={e => setValue(e.currentTarget.value)}>\n        {items.map((item: string, i: number) => (\n          <option key={i}>{item}</option>\n        ))}\n      </Select>\n    </BaseControl>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsString } from '../../types';\n\nconst Input = styled.input`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport const StringControl = React.memo(\n  ({ name, setValue, value }: ControlComponentProps<ControlOptionsString>) => {\n    return (\n      <BaseControl label={name}>\n        <Input value={value} onChange={e => setValue(e.target.value)} />\n      </BaseControl>\n    );\n  }\n);\n","import React, { useRef } from 'react';\nimport { animated, useSpring, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { clamp, map } from '../../utils';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsXYPad } from '../../types';\n\n// When to just show 0 instead of 0.000000012333\nconst THRESHOLD = 0.00001;\n\nexport const XYPadControl = ({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsXYPad>) => {\n  const stage = useRef(null);\n  const { distance = 1, scrub = false } = options;\n  const [ref, { width, height }] = useMeasure();\n\n  const [cursor, setCursor] = useSpring(\n    () => ({\n      from: {\n        x: value.x,\n        y: value.y,\n      },\n\n      onChange(value: any, b: any) {\n        const clampMx = b.key === 'x' ? width : height;\n        const v =\n          clamp(map(value, 0, clampMx / 2, 0, distance), -distance, distance) ||\n          0;\n        if (!scrub) {\n          setValue((prev: any) => ({\n            ...prev,\n            [b.key]: v < THRESHOLD && v > -THRESHOLD ? 0 : v,\n          }));\n        }\n      },\n    }),\n    [width, height]\n  ) as any;\n\n  const bind = useDrag(({ down, movement }) => {\n    if (down && !stage.current) {\n      stage.current = value;\n    } else if (!down) {\n      stage.current = null;\n    }\n\n    setCursor({ x: down ? movement[0] : 0, y: down ? movement[1] : 0 });\n\n    if (scrub) {\n      if (down) {\n        setValue(() => ({\n          x:\n            (stage as any).current.x +\n            map(movement[0], 0, width / 2, 0, distance),\n          y:\n            (stage as any).current.y +\n            map(movement[1], 0, height / 2, 0, distance),\n        }));\n      } else {\n        stage.current = value;\n      }\n    }\n  });\n\n  const x = cursor.x.to((n: number) => clamp(n + width / 2, 0, width));\n  const y = cursor.y.to((n: number) => clamp(n + height / 2, 0, height));\n\n  return (\n    <BaseControl\n      stack\n      label={name}\n      value={`x: ${value.x.toFixed(1)}, y: ${value.y.toFixed(1)}`}\n    >\n      <animated.svg\n        ref={ref as any}\n        style={{\n          userSelect: 'none',\n          borderRadius: 8,\n          border: '1px solid #f0f0f0',\n        }}\n        width=\"100%\"\n        height={200}\n        xmlns=\"http://www.w3.org/2000/svg\"\n        {...bind()}\n      >\n        <rect fill=\"rgb(250, 250, 250)\" width=\"100%\" height=\"100%\" />\n        <animated.line x1={x} x2={x} y1={0} y2=\"100%\" stroke=\"#ccc\" />\n        <animated.line x1={0} x2=\"100%\" y1={y} y2={y} stroke=\"#ccc\" />\n        <animated.g\n          style={{\n            transform: to([x, y], (x, y) => `translate(${x}px, ${y}px)`),\n          }}\n        >\n          <circle r={8} fill=\"#ccc\" />\n          <circle r={4} fill=\"#aaa\" />\n        </animated.g>\n      </animated.svg>\n    </BaseControl>\n  );\n};\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsFile } from '../../types';\nimport * as THREE from 'three';\n\nconst FileInput = styled.input`\n  width: 100%;\n`;\n\nexport const FileControl = ({\n  name,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsFile>) => {\n  return (\n    <BaseControl label={name}>\n      <FileInput\n        type=\"file\"\n        onChange={e => {\n          const loader = options.loader ?? new THREE.FileLoader();\n          if ((loader as any).setCrossOrigin) {\n            (loader as THREE.TextureLoader).setCrossOrigin('');\n          }\n          const file = e.currentTarget.files && e.currentTarget.files[0];\n          const texture = loader.load(URL.createObjectURL(file));\n          setValue(texture);\n        }}\n      />\n    </BaseControl>\n  );\n};\n","import React, { useContext, useEffect, useState } from 'react';\nimport { ControlsContext } from '../contexts/controls-context';\nimport {\n  ControlType,\n  ControlOptions,\n  ControlComponentProps,\n  ControlOptionsCustom,\n} from '../types';\nimport { NumberControl } from './controls/number-control';\nimport { BooleanControl } from './controls/boolean-control';\nimport { BaseControl } from './controls/base-control';\nimport { ButtonControl } from './controls/button-control';\nimport { ColorControl } from './controls/color-control';\nimport { SelectControl } from './controls/select-control';\nimport { StringControl } from './controls/string-control';\nimport { XYPadControl } from './controls/xy-pad-control';\nimport { FileControl } from './controls/file-control';\n\nconst ControlComponents = {\n  [ControlType.NUMBER]: NumberControl,\n  [ControlType.BOOLEAN]: BooleanControl,\n  [ControlType.SELECT]: SelectControl,\n  [ControlType.COLOR]: ColorControl,\n  [ControlType.STRING]: StringControl,\n  [ControlType.BUTTON]: ButtonControl,\n  [ControlType.FILE]: FileControl,\n  [ControlType.XYPAD]: XYPadControl,\n};\n\nconst Noop = ({ name, options }: any) => (\n  <BaseControl label={name}>\"{options.type}\" not found</BaseControl>\n);\n\nexport const ControlItem = ({\n  name,\n  id,\n  value: defaultValue,\n  options,\n}: ControlComponentProps<ControlOptions>) => {\n  const context = useContext(ControlsContext);\n\n  const [value, setValue] = useState(\n    context.values.current && context.values.current.has(id)\n      ? context.values.current.get(id)\n      : defaultValue\n  );\n\n  useEffect(() => {\n    context.values.current!.set(id, value);\n  }, [context.values, id, value]);\n\n  useEffect(() => {\n    context.gui.current!.set(id, setValue);\n  }, [context.gui, id]);\n\n  const Component =\n    (options as ControlOptionsCustom).component ??\n    (ControlComponents as any)[options.type ?? ControlType.NUMBER] ??\n    Noop;\n\n  return (\n    <Component\n      id={id}\n      name={name}\n      value={value}\n      setValue={(newValue: any) => {\n        context.gui.current?.get(id)?.(newValue);\n        context.state.current?.get(id)?.(newValue);\n      }}\n      options={options}\n    />\n  );\n};\n","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport { ControlItem } from './control-item';\n\nconst Heading = styled.h2<{ open: boolean }>`\n  display: block;\n  font-family: sans-serif;\n  font-size: 13px;\n  font-weight: bold;\n  padding-left: 16px;\n  cursor: pointer;\n  position: relative;\n  user-select: none;\n\n  &:before,\n  &:after {\n    content: '';\n    position: absolute;\n    top: 8px;\n    right: 16px;\n    width: 12px;\n    height: 2px;\n    background-color: #333;\n    /* transition: transform 0.25s ease-out; */\n  }\n  &:before {\n    transform: rotate(${props => (props.open ? 0 : 90)}deg);\n  }\n\n  &:after {\n    transform: rotate(${props => (props.open ? 0 : 180)}deg);\n  }\n`;\n\nconst Container = styled.div<{ open: boolean; bg: boolean }>`\n  background: ${props => (props.bg ? '#f9f9f9' : '#fff')};\n  padding: 16px;\n  display: ${props => (props.open ? 'block' : 'none')};\n  margin-bottom: 8px;\n`;\n\nexport const ControlGroup = ({ title, controls, options = {} }: any) => {\n  const [open, setOpen] = useState(!options.defaultClosed ?? true);\n  const isDefault = title !== 'DEFAULT_GROUP';\n  return (\n    <div>\n      {isDefault && (\n        <Heading open={open} onClick={() => setOpen(o => !o)}>\n          {title}\n        </Heading>\n      )}\n      <Container open={open} bg={isDefault}>\n        {Array.from(controls).map((control: any) => (\n          <ControlItem key={`${control.id}_${control.name}`} {...control} />\n        ))}\n      </Container>\n    </div>\n  );\n};\n","import React, { useContext } from 'react';\nimport { ControlsProvider, Canvas } from './controls-provider';\nimport styled from 'styled-components';\nimport { animated, useSpring, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { clamp } from '../utils';\nimport { DEFAULT_GROUP } from '../types';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { useLocalStorage } from '../hooks/use-local-storage';\nimport { ControlGroup } from './control-group';\n\nconst mq = `@media only screen and (max-width: 600px)`;\n\ninterface FloatProps {\n  'data-width': number;\n  'data-anchor': ControlsAnchor | string;\n}\n\nexport enum ControlsAnchor {\n  TOP_LEFT = 'top_left',\n  TOP_RIGHT = 'top_right',\n  BOTTOM_LEFT = 'bottom_left',\n  BOTTOM_RIGHT = 'bottom_right',\n}\n\nexport interface ControlsProps {\n  /**\n   * Title to show on the controls\n   */\n  title?: string;\n  /**\n   * Collapsed by default\n   */\n  collapsed?: boolean;\n  /**\n   * Array of group names as strings\n   */\n  defaultClosedGroups?: string[];\n  /**\n   * Defaults to 300\n   */\n  width?: number;\n  /**\n   * Anchor point\n   */\n  anchor?:\n    | ControlsAnchor\n    | 'top_left'\n    | 'bottom_left'\n    | 'top_right'\n    | 'bottom_right';\n  /**\n   * Styles\n   */\n  style?: any;\n}\n\nfunction posProps(positions: ControlsAnchor[]) {\n  return function posPropsFn(props: any) {\n    return positions.includes(props['data-anchor']) ? '16px' : 'auto';\n  };\n}\n\nconst Float = styled(animated.div)<FloatProps>`\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  top: ${posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.TOP_RIGHT])};\n  right: ${posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.TOP_RIGHT])};\n  bottom: ${posProps([\n    ControlsAnchor.BOTTOM_RIGHT,\n    ControlsAnchor.BOTTOM_LEFT,\n  ])};\n  left: ${posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT])};\n  width: ${props => props['data-width']}px;\n  border-radius: 16px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);\n\n  ${mq} {\n    transform: none !important;\n    flex-direction: column-reverse;\n    top: auto;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    width: auto;\n  }\n`;\n\nconst Header = styled(animated.div)<{ 'data-collapsed': boolean }>`\n  display: flex;\n  align-items: center;\n  position: relative;\n  padding-left: 16px;\n  padding-right: 16px;\n  height: 42px;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: #fff;\n  cursor: move;\n  cursor: grab;\n  user-select: none;\n  background-color: #000;\n  border-top-left-radius: 8px;\n  border-top-right-radius: 8px;\n  border-bottom-left-radius: ${props => (props['data-collapsed'] ? 0 : 8)}px;\n  border-bottom-right-radius: ${props => (props['data-collapsed'] ? 0 : 8)}px;\n  box-shadow: 0 0 14px 0 rgba(0, 0, 0, 0.14);\n  ${mq} {\n    border-top-left-radius: 0px;\n    border-top-right-radius: 0px;\n    border-bottom-left-radius: 0px;\n    border-bottom-right-radius: 0px;\n  }\n`;\n\nconst CollapseIcon = styled.div<{ collapsed: boolean }>`\n  width: 30px;\n  height: 18px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: auto;\n  cursor: pointer;\n  &:after {\n    content: '';\n    display: block;\n    height: 3px;\n    width: 16px;\n    background-color: white;\n  }\n  ${mq} {\n    &:before {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n    }\n  }\n`;\n\nconst Items = styled(animated.div)`\n  padding-bottom: 8px;\n  overflow-y: auto;\n  max-height: calc(100vh - 42px);\n`;\n\nconst groupByGroup = (items: any): any => {\n  return Array.from(items).reduce((acc: any, item: any) => {\n    const groupName = item?.options?.group || DEFAULT_GROUP;\n    acc[groupName] = acc[groupName] || [];\n    acc[groupName].push(item);\n    return acc;\n  }, {} as { [key: string]: any });\n};\n\ninterface ControlsFn {\n  (props: ControlsProps): JSX.Element;\n  Provider: typeof ControlsProvider;\n  Canvas: typeof Canvas;\n}\n\nexport const Controls: ControlsFn = (props: ControlsProps) => {\n  const {\n    title = 'react-three-gui',\n    defaultClosedGroups = [],\n    width = 300,\n    style = {},\n    anchor = ControlsAnchor.TOP_RIGHT,\n  } = props;\n  const { controls } = useContext(ControlsContext);\n  const [collapsed, setCollapsed] = useLocalStorage(\n    'REACT_THREE_GUI__COLLAPSED',\n    props.collapsed\n  );\n  const [position, setPosition] = useLocalStorage(\n    `REACT_THREE_GUI__${anchor}`,\n    [0, 0]\n  );\n  const [ref, bounds] = useMeasure();\n  const [{ pos }, setPos] = useSpring(() => ({\n    pos: position,\n    onRest({ value }) {\n      setPosition(value);\n    },\n  }));\n  const left = [ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT].includes(\n    anchor as any\n  );\n  const top = [ControlsAnchor.TOP_RIGHT, ControlsAnchor.TOP_LEFT].includes(\n    anchor as any\n  );\n  const bind = useDrag(\n    ({\n      movement,\n      memo = pos\n        ? (pos as any).getValue\n          ? (pos as any).getValue()\n          : (pos as any).get()\n        : 0,\n    }) => {\n      const [x, y] = [movement[0] + memo[0], movement[1] + memo[1]];\n      setPos({\n        pos: [\n          left\n            ? clamp(x, 1, window.innerWidth - width - 32)\n            : clamp(x, -window.innerWidth + width + 32, 1),\n          top\n            ? clamp(y, 1, window.innerHeight)\n            : clamp(y, -window.innerHeight + bounds.height + 32, 1),\n        ],\n      });\n      return memo;\n    }\n  );\n\n  const getGroupOptions = (groupName: string): any => {\n    return {\n      defaultClosed: defaultClosedGroups?.includes(groupName) ?? false,\n    };\n  };\n\n  const groups = groupByGroup(controls);\n\n  return (\n    <Float\n      data-width={width}\n      data-anchor={anchor}\n      ref={ref}\n      style={{\n        ...style,\n        transform: to(\n          [pos] as any,\n          ([x, y]) => `translate3d(${x}px,${y}px,0)` as any\n        ),\n      }}\n    >\n      <Header data-collapsed={collapsed} {...bind()}>\n        {title}\n        <CollapseIcon\n          collapsed={collapsed}\n          onClick={() => setCollapsed((c: boolean) => !c)}\n        />\n      </Header>\n      <Items\n        hidden={!collapsed}\n        style={{\n          maxHeight: top\n            ? to([pos] as any, ([_, y]) => `calc(100vh - ${y + 92}px)` as any)\n            : undefined,\n        }}\n      >\n        {Object.entries(groups).map(([groupName, items]: any) => (\n          <ControlGroup\n            key={groupName}\n            title={groupName}\n            controls={items}\n            options={getGroupOptions(groupName)}\n          />\n        ))}\n      </Items>\n    </Float>\n  );\n};\n\nControls.Provider = ControlsProvider;\nControls.Canvas = Canvas;\n","import { useState, useEffect, useContext } from 'react';\nimport { useSpring } from '@react-spring/three';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { ControlOptions, ControlItem } from '../types';\nimport { defaultOptions, defaultValue } from '../utils';\n\nexport const useControl = (\n  name: string,\n  options: ControlOptions = defaultOptions\n) => {\n  const context = useContext(ControlsContext);\n  const [id, setId] = useState<string | null>(null);\n  let [value, setValue] = useState(defaultValue(options));\n\n  const [spring, setSpring] = useSpring(() => ({\n    value,\n    config: typeof options.spring === 'object' ? options.spring : undefined,\n  }));\n  const setSpringValue = (springValue: any) =>\n    setSpring({ value: springValue });\n\n  if (options.state) {\n    value = options.state[0];\n    setValue = options.state[1];\n  }\n\n  useEffect(() => {\n    if (context.state.current && id) {\n      if (options.spring) {\n        context.state.current.set(id, setSpringValue);\n      } else {\n        context.state.current.set(id, setValue);\n      }\n    }\n  }, [context.state, id]);\n\n  useEffect(() => {\n    const ctrl = context.addControl({\n      id: options.id,\n      name,\n      value,\n      options,\n    } as ControlItem);\n    setId(ctrl.id);\n    return () => {\n      context.removeControl(ctrl);\n    };\n  }, []);\n\n  useEffect(() => {\n    options.spring && void setSpring({ value });\n    options.onChange && void options.onChange(value);\n  }, [options, setSpring, value]);\n\n  if (options.spring) {\n    return spring.value;\n  }\n\n  return value;\n};\n"]},"metadata":{},"sourceType":"module"}